<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Bioinformatics on UncleCAT4</title><link>https://yuanj.top/posts/bioinformatics/</link><description>Recent content in Bioinformatics on UncleCAT4</description><generator>Hugo -- gohugo.io</generator><language>en-US</language><copyright>Copyright © 2023, YuanJ.</copyright><lastBuildDate>Wed, 11 Oct 2023 17:17:52 +0800</lastBuildDate><atom:link href="https://yuanj.top/posts/bioinformatics/index.xml" rel="self" type="application/rss+xml"/><item><title>[置顶] 专题：RNA-Seq 上游分析学习</title><link>https://yuanj.top/posts/ds89sdf/</link><pubDate>Thu, 07 Sep 2023 17:16:07 +0800</pubDate><guid>https://yuanj.top/posts/ds89sdf/</guid><description>转录组测序的研究对象为特定细胞在某一功能状态下所能转录出来的所有 RNA 的总和，包括 mRNA 和非编码 RNA，相对于传统的芯片杂交平台，转录组测序无需预先针对已知序列设计探针，即可对任意物种的整体转录活动进行检测，提供更准确的数字化信号，更高的检测通量以及更广泛的检测范围，是目前深入研究转录组复杂性的强大工具，基于高通量测序平台的转录组测序技术能够全面获得物种特定组织或器官的转录本信息，从而进行基因表达水平研究、新转录本发现研究、转录本结构变异研究等
RNA-seq 概述 版本信息 一些名词解释 大致流程 软件安装 数据获取与预处理 测序数据下载 参考基因组及注释文件 FastQc 质控 常用参数 进行质量检测 Trimmomatic 过滤低质量序列 常用参数 过滤低质量序列 hisat2 比对 建立索引 常用参数 进行比对 samtools 排序压缩 常用命令 排序压缩 featureCounts 生成基因计数表 常用参数 计数统计 参考 RNA-seq 概述 RNA-seq 是研究转录组应用最广泛，也是最重要的技术之一，RNA-seq 分析内容包括序列比对、转录本拼接、表达定量、差异分析、融合基因检测、可变剪接、RNA 编辑和突变检测等，具体流程和常用工具如下图所示，通常的分析不一定需要走完全部流程，按需进行，某些步骤可以跳过、简化等
RNA-seq 中最常用的分析方法就是找出差异表达基因 (Differential gene expression, DEG)，在实验室中，标准流程就分为三步：
step1: 构建测序文库，包括提取 RNA, 富集 mRNA 或清除核糖体 RNA, 合成 cDNA, 加上接头 step2: 在高通量测序平台（通常为 Illumina） 上对文库进行测序，每个样本的测序深度为 10-30M 读长 step3: 数据分析，具体而言：对测序得到的读长进行比对或组装到转录本上；对覆盖到每个基因区域的读长进行计数；根据统计模型鉴定不同样本间差异表达的基因，（这种分析过程是比较传统的方法） 版本信息 成都理工大学超算平台 Red Hat 4.</description></item><item><title>[置顶] 专题：基因家族鉴定</title><link>https://yuanj.top/posts/a4559e49/</link><pubDate>Thu, 01 Jun 2023 14:35:34 +0000</pubDate><guid>https://yuanj.top/posts/a4559e49/</guid><description>完整的基因家族鉴定流程，包含基因家族鉴定和基因家族的性质分析、基因分析、进化分析等
本文已在 GitHub 开源，开源地址为 Gene-family-identification
国内镜像仓库 Gene-family-identification
可以在仓库的 exampledata 文件夹中查看示例数据
概念 研究思路 前期准备工作 查找基因的结构域 搜索相关文献 基因组序列文件与注释文件下载 隐马尔可夫模型下载 基因家族鉴定 HMMER 查找 Blast 比对 进一步确定基因家族成员 结构域分析 Motif 分析 构建系统发育树 基因家族的性质分析 理化性质分析 染色体定位分析 基因家族成员的基因分析 内含子和外显子结构 基因表达量分析 基因家族的进化分析 互作蛋白网络 顺式作用元件分析 多序列比对 共线性分析 多图结合 基因家族的功能研究 GO 富集分析 KEGG 富集分析 总结 致谢 基因是染色体上一段可以发生转录的区域包括内含子（intron）、外显子（exon）、启动子（promoter），转录本（transcript）才是基因的研究实体。
基因家族来源于同一个祖先，由同一个基因通过基因重复而产生两个或更多的拷贝而构成的一组基因，其在结构和功能上就有明显的相似性，编码相似的蛋白质产物，同意家族基因可以紧密排列在一起，形成一个基因簇，但多数时候，他们分散在同一染色体的不同位置，或存在于不同的染色体上，各自有不同的表达调控模式。
序列高度相似的序列，互为同源基因（homologous gene），归属于一个基因家族。
有时定义基因家族，从结构域角度来刻画。如：一类基因，其编码蛋白都含有同一个结构域，这一类基因是一个基因家族。这个定义信息更偏向功能信息，一般来说结构域决定某种功能，因为结构域序列保守，易形成稳定的三维结构。这与共同祖先的定义有些差别，很多结构域难找得到其共同祖先。另外一个基因的共同祖先定义比较复杂的，越是历史久远的祖先，因为物种的在进化过程中发生了很多丢失和增加事件。共同祖先是个相对的概念，比如植物的共同祖先，一般包括藻类及其它绿色植物，而被子植物共同祖先，根据已经测序的基因组，一般指单双子叶之前就可以。如果从共同祖先定义基因家族，很多已知的基因家族就要被分成很多个基因家族。有很多网站（数据库）专门收集结构域，比如 Pfam 和 InterPro，这两个数据库内容差不多。这些数据库以 Hmmer 算法为基础，根据 Uniprot 中包含的蛋白，进行序列连配找到保守的片段（结构域），再以这些序列使用 Hmmer 构建种子，保存这些种子。一个蛋白拿过来后，与这些种子比对，根据打分能判断出这个蛋白是不是含有这个结构域，这也是判断一个基因编码蛋白是不是属于这个家族。
研究思路 关于基因家族的鉴定思路主要包括以下部分：
基因家族成员鉴定
确定研究的基因家族 家族成员的基本特征确定（参考已有物种） 参考序列集合的准备或下载该基因家族的隐马尔科夫模型 目标物种序列和注释信息的下载或准备 双向 Blast 比对或 HMMER Search 获取可能的成员 基于保守结构域进行进一步筛选 结合系统发育树、保守结构域和保守基序（motif）等确定最终的基因家族成员 基因家族成员的性质分析</description></item><item><title>使用 HMMER 网页工具进行结构域分析</title><link>https://yuanj.top/posts/asdh8723ko23/</link><pubDate>Wed, 11 Oct 2023 17:17:52 +0800</pubDate><guid>https://yuanj.top/posts/asdh8723ko23/</guid><description>由于数据库之间的差异，使用 NCBI CDD Search 搜索结构域有时候并不能满足我们的需要，比如我们通常使用 HMMER 来鉴定同一家族的基因并且需要进行结构域可视化，但 HMMER 所使用的数据都来自 pfam，它的数据库可能与 NCBI 的不同，因此而造成结果上的差异，有的时候这种情况会影响我们后面的研究，于是，使用 hmmer 网页工具 来进行结构域分析可能会更好。
打开 hmmer 网页工具，还是一样，上传序列，写下邮件地址，然后提交
完成后会收到邮件
将邮件末尾的结构域信息保存到文本文件中
使用 TBtools 的 Visualize Pfam Domain Pattern 工具进行可视化，导入刚刚保存的结构域信息、蛋白序列（前面上传的）和基因 ID 列表，点击 start 出图即可
保存时建议保存为 svg 格式，更加清晰，也更方便二次修改。</description></item><item><title>最新版 HMMER 查找同源基因</title><link>https://yuanj.top/posts/hmmd234csda/</link><pubDate>Tue, 10 Oct 2023 19:40:49 +0800</pubDate><guid>https://yuanj.top/posts/hmmd234csda/</guid><description>pfam 官网已经通知，将数据迁移到 interpro 了，所以之前下载 hmm 模型的方法已经不适应了，需要进行一些改变。
打开 interpro 网站，首页往下翻，找到 pfam
搜索结构域
进入结构域的详情页面，点击左栏的 Alignment，选择 seed 然后下载种子文件，下载后是一个压缩包，解压后是 SEED.ann 文件，与之前旧版数据库里的 PFseed_xxxx.txt 是一样的。
接着再点击左栏的 Curation，下载 hmm 模型文件。
之后的 HMMER 的使用就和之前一样，没什么变化了。</description></item><item><title>蛋白质的结构组织层次</title><link>https://yuanj.top/posts/proeiwhf89/</link><pubDate>Mon, 02 Oct 2023 13:44:55 +0800</pubDate><guid>https://yuanj.top/posts/proeiwhf89/</guid><description>一级结构（primary structure） 蛋白质的一级结构就是指氨基酸残基在肽链上的排列顺序，也就是蛋白质的序列，例如下面的黑麦草中的一个基因的蛋白一级结构
&amp;gt;KYUSt_chr1.28019 MHASVRLLRRLSSSSSPRSLRRLPFHPSPLPSPHPLPLPILRTRAPLPRLAGRRFSTISCASTPSLRLGECGALGTPAIPEVEKSEGEEEVDSLAARHDTDAFAAVELALDSVVKVFTVSSGPNYFLPWQNKSQRESMGSGFVISGRRIITNAHVVADHTFVLVRKHGSPTKYKAEVQAVGHECDLALLTVESEEFWEGMNSLDLGDIPFLQEAVAVVGYPQGGDNISVTKGVVSRVEPTQYAHGATQLMAIQIDAAINPGNSGGPAIMGDKVAGVAFQNLSGAENIGYIIPVPIINRFISGVEESGKYSGFCSLGISCQATENIQIRECFGMRPEMTGVLVSRINPLSDAYKVLKKDDILLEFDGVPIANDGTVPFRNRERITFDHLVSMKKPEETSVIKVLRDGKEHELTVTLRPLQPLVPVHQFDKVPSYYIFAGFVFIPLSQPYLHEFGEDWYNTSPRRLCERALRELPKKAGQQLVILSQVLMDDINVGYERLAELQVKKVNGVEVENLKHLCSIVEGCTEENLRFDLDDERVIVLKFQNAKLATSRILKRHRIPSAMSNDLFDEQGSNDAEGRGLPGALHWLRRLLFG 蛋白质的一级结构是后面所有高级结构的基础，也是决定更高层结构的主要因素。天然蛋白质中常见的氨基酸大概有 20 种，这些氨基酸个体通过肽键共价结合。如果两个不同的蛋白质具有相似的一级结构，那么我们可以称这两个蛋白质彼此同源（homology）。
二级结构（secondary structure） 蛋白质的二级结构指多肽链的主链原子在氢键作用下沿一维方向排列成具有周期性的结构构象，这是多肽链局部的空间（结构）构象。主要有α螺旋、β折叠、β转角、无规则卷曲等形式。
α螺旋（α-helix） 蛋白质中最常见、最典型、含量最丰富的结构元件，是一种重复性结构。由于肽链中的全部肽键都可形成氢键，故α-螺旋十分稳定。
其结构特征为：
主链骨架围绕中心轴形成右手结构 螺旋每上升一圈为 3.6 个氨基酸残基，螺距为 0.54nm 相邻螺旋圈之间形成氢键 侧链基团位于螺旋外侧 不利于α螺旋形成的原因有：
侧链基团存在较大的氨基酸残基 连续存在带相同电荷的氨基酸残基 存在脯氨酸残基 β折叠（β-pleated sheet） 折叠一般有两种形式，一种为平行式，另一种自然为反平行式。两者的区别就如字面意思一样，平行β折叠即相邻肽链是同向的，反平行式为逆向的。
其结构特征为：
若干条肽链或肽段平行或者反平行排列成片 所有肽键的 C=O 和 N-H 形成链间氢键 侧链基团分别交替位于片层的上、下方 β转角（β-turn） 通常发生在多肽链 180°回折时的转角上，通常由 4 个氨基酸残基构成，借助第一和第四残基之间形成氢键，从而形成一个紧密的环。已经发现的蛋白质的抗体识别、磷酸化、糖基化和羟基化位点经常出现在转角和紧靠转交。
无规卷曲（random coli） 无规卷曲就是指主链骨架无规律排列形成的构象，也泛指那些不能归入明确的二级结构的多肽区域。常出现在α螺旋与α螺旋、α螺旋与β折叠、β折叠与β折叠之间。
二级结构预测 下面的三个网站都可以用于蛋白质二级结构预测
Psipred Novopro Prabi 以 Novopro 网站为例，上传前面所提到的那个黑麦草的序列，得到下面的结果
输出结果中，粉色块代表α螺旋，白色块代表卷曲，黄色块代表β折叠。还有一个更加形象的图：
超二级结构和结构域 超二级结构（supersecondary structure）和（domain）是介于二级和三级结构之间的空间构象。
超二级结构为那些相邻的二级结构单元体组合在一起，排列形成具有规则的、能够在空间结构上辨识的二级结构组合体，同时又可以充当三级结构的功能部件，常见的形式由αα、ββ、βαβ等。
结构域就是在超二级结构的基础上形成的三维局部折叠区域，通常相对独立并且具有一定的生物学功能。一个较大的蛋白质分子通常具有多个结构域。
此外我们常说的模体（motif）或者模序，它是结构域的亚单位，长度从几个氨基酸残基到几十个氨基酸残基不等，相当于超二级结构，一般为α螺旋、β折叠和环（loop）。
我们通常在基因家族鉴定中会做 domain 分析和 motif 分析实则就是将其可视化，更便于查看，可以通过 NCBI CDD tool 搜索结构域，使用 MEME 网站 查询 motif。</description></item><item><title>RNA Seq 上游分析实践</title><link>https://yuanj.top/posts/kjasdf98/</link><pubDate>Fri, 08 Sep 2023 20:29:36 +0800</pubDate><guid>https://yuanj.top/posts/kjasdf98/</guid><description>之前那一篇文章主要讲的是一些知识与工具的用法，这次用六组数据进行分析，得到基因表达矩阵
还是先从 NCBI 搜索数据，查看数据是双端测序的数据之后，多选条目，直接 Accession list
我使用的是下列数据
SRR25907783 SRR25907784 SRR25907785 SRR25907786 SRR25907787 SRR25907788 使用 sra-tools 批量下载数据，并且使用 nohup 把程序挂在后台下载
nohup prefetch --option-file acc_list.txt 再使用脚本进行拆分
#!/bin/bash mkdir SRR mv ./SRR*/*.sra ./SRR cd SRR nohup fastq-dump --gzip --split-3 SRR*.sra 这里千万不要在程序没有运行完成的时候就进行下一步操作，使用 top 可以查看后台进程
当程序运行完成后便可看到后台任务中已经没有前面运行的程序了
同一目录下的 nohup.out 文件中是后台进程的运行记录
拆分完成后就需要进行质量检测，使用通配符批量检测，并且将检测报告放在单独一个文件夹以便后面进行压缩
mkdir fastqc_report fastqc SRR2590778*.fastq.gz -o ./fastqc_report 完成之后，将检测报告进行压缩，以便下载查看
zip -r fastqc_report.zip fastqc_report/*.html 依据检测报告对序列进行过滤，参数之前已经讲过，这里数据比较多，写一个 bash 脚本的 for 循环
#!/bin/bash for i in {3..8} do trimmomatic PE -threads 1 -phred33 SRR2590778${i}_1.</description></item><item><title>转录组学分析基础——测序技术</title><link>https://yuanj.top/posts/ia87asdf52/</link><pubDate>Fri, 01 Sep 2023 11:12:16 +0800</pubDate><guid>https://yuanj.top/posts/ia87asdf52/</guid><description>转录组的研究对象为特定细胞在某一功能状态下所能转录出来的所有 RNA 的总和，其原始数据便是测序文件，因而了解测序技术对进行转录组学分析具有重要的意义
第一代测序技术 1975 年由 Frederick Sanger 所提出的链终止法以及 1977 年由 Walter Gibert 所发明的链降解法被称为第一代测序技术。
1977 年，Walter Gilbert 和 Frederick Sanger 发明了第一台测序仪，并应用其测定了第一个基因组序列，噬菌体 X174，全长 5375 个碱基。Walter Gilbert 和 Frederick Sanger 也因在测序技术中的贡献获得了 1980 年诺贝尔化学奖。
第一代测序技术大体上是仿照 DNA 合成的原理来进行的，正常的 DNA 合成主要分为以下几个步骤
高温变性、退火 引物与 DNA 单链结合 dNTP（脱氧核糖核酸）与引物借助 DNA 聚合酶结合形成单链 合成双链 Sanger 测序技术大致分为以下几个步骤
高温变性、退火 引物与单链（目标序列）结合 在 DNA 聚合酶的作用下 ddNTP、dNTP 与引物相结合形成不同长度的 DNA 片段 通过电泳技术将不同长度的 DNA 片段分开 根据不同长度片段的最后一个碱基拼接得到完整序列信息 实际上 Sanger 测序的核心在于形成不同长度的 DNA 片段。在四个容器中分别加入 DNA 合成所需要的模板链、四种 dNTP、引物和一种 ddNTP，由于 ddNTP 和 dNTP 一样，可以与 dNTP 结合，但 ddNTP 在与 dNTP 结合后便不能再与 dNTP 结合，并且与 ddNTP 结合的位点是随机的，那么在一个容器中放入大量的反应物（ddNTP 只放入一种）便可以得到许多不同长度的序列片段，四个容器分别放入四种不同的 ddNTP 并且分别加入一定比例带有放射性同位素标记的 ddNTP。</description></item><item><title>TBtools 序列信息统计及序列操作</title><link>https://yuanj.top/posts/76asdja/</link><pubDate>Mon, 21 Aug 2023 20:02:39 +0800</pubDate><guid>https://yuanj.top/posts/76asdja/</guid><description>使用 TBtools 的 Fasta Stats 和 Sequence Manipulate 工具帮助我们迅速地统计信息及序列操作
Fasta Stats 该工具可获取 Fasta 序列的以下信息：
Total_Len（序列总长） Total_Seq_Num（染色体数） Total_N _Counts（未测通的碱基数） Total_LowCase_Counts（重复序列的标志） Total_GC_content（GC 含量） Minimum Len（最小序列长度） Maximum Len（最大序列长度） Mean Len（平均序列长度） Median Len（序列中位数长度） N50 打开工具，输入序列并设置输出目录即可查看信息
输出目录下会有一个 excel 文件，显示序列长度与描述
Sequence Manipulate 该工具可以对序列进行以下操作（可勾选多个组合使用）：
Reverse（反向） Complement（互补） RNA（序列对应的 RNA 序列） UpperCase（大写） LowerCase（小写） Only IDs（只显示序列 ID） Only Seqs（只显示序列信息） Seq in one Line（序列显示在一行） Bases per Line（每一行的碱基数，设置需要取消勾选 [Seq in one Line]） 直接粘贴序列，选择操作选项即可</description></item><item><title>植物基因组蛋白质序列的制备</title><link>https://yuanj.top/posts/ka87as/</link><pubDate>Fri, 18 Aug 2023 17:59:26 +0800</pubDate><guid>https://yuanj.top/posts/ka87as/</guid><description>一般情况下，植物基因组 DNA 序列及注释文件可以在 ensembl 网站直接下载到，但蛋白质序列貌似不是很好下载，各处下载的序列文件格式、ID 等都有很大的不同，NCBI 上的也比较杂乱，所以还是自己翻译为好，这里依旧使用 TBtools
数据下载 其实在 ensembl 网站 可以下载到 DNA 序列、蛋白质序列及注释文件，但蛋白质序列的 ID 格式比较乱
我比较喜欢由 ID 直接对应序列的
先从 ensembl 网站 下载 DNA 序列及注释文件
打开 ensembl 网站 后，直接在首页的物种列表里选择物种，我们课题组主要做水稻，我就以水稻为例
点击物种详情页的 Download DNA sequence 就会跳转到 DNA 序列的 ftp 页面
以 dna.toplevel 结尾的就是基因组的全部 DNA 序列，其他的是各条染色体上的基因的 DNA 序列
回到详情页，点击 Gene annotation 下的 GFF3 下载注释文件
下载整个基因组的注释文件，而不是各条染色体的
再回到详情页，点击 Gene annotation 下的 FASTA
跳转到 ftp 页面之后我们可以看到这里有 DNA、ncrna、cDNA、CDS 及蛋白质（pep）
打开 pep 文件夹下载所有蛋白质序列
但这个蛋白质序列的 ID 很长，所以我们自己制备蛋白质序列</description></item><item><title>WSL 搭建生信分析环境</title><link>https://yuanj.top/posts/jdksf7d9/</link><pubDate>Tue, 15 Aug 2023 20:49:31 +0800</pubDate><guid>https://yuanj.top/posts/jdksf7d9/</guid><description>在做生信分析的时候，很多情况下都会用到 Linux 环境，而大多数人的电脑都是 Windows 环境，目前 Windows 下使用 Linux 最主流的两种方法就是服务器和虚拟机，但服务器的价格比较高，并且在文件传输等方面不太方便；虚拟机对电脑的要求比较高，并且占用也很大、启动时间长且配置较为麻烦，现如今，在 Windows 上已经有 WSL 了，使用它做生信分析极大地提高了效率，避免了很多问题
WSL 的优点 安装、配置方便，Windows10/11 原生集成，可迅速安装配置 启动速度快，配合 VScode 可迅速进入工作状态 占用低，可以通过 .wslconfig 来限制占用的硬件资源 文件传输方便，可以直接打开 Windows 下的文件 WSL2 已支持图形界面 与 Windows 系统互相独立互不干扰 可以备份恢复，便于迁移 WSL 的缺点 由于 WSL2 与 Windows 通过网络协议互相访问，导致直接访问 Windows 系统下的文件时速度会下降 Windows 自带的 openssh 版本低，导致 VScode 会与 WSL 断开连接 WSL 下使用 Windows 代理时需要配置 默认安装在 C 盘，但可以自行下载安装包解压后安装在其他盘 WSL 的安装 参考我的文章 Windows10 &amp;amp; 11 安装 WSL2
WSL 的配置 此处默认以 Debian 系为例，我使用的是 Debian11</description></item><item><title>Linux 下安装 BUSCO</title><link>https://yuanj.top/posts/24ed802/</link><pubDate>Fri, 21 Jul 2023 17:22:17 +0000</pubDate><guid>https://yuanj.top/posts/24ed802/</guid><description>Benchmarking Universal Single-Copy Orthologs (BUSCO) 是用于评估基因组组装和注释的完整性的工具 通过与已有单拷贝直系同源数据库的比较，得到有多少比例的数据库能够有比对，比例越高代表基因组完整度越好 官网说 BUSCO 直接可以用 conda 安装，但&amp;hellip; 我从来没有成功过，经过多次的实践，总结了能够成功安装 BUSCO 的方法&amp;hellip;
可以评估三种数据类型：
组装的基因组 转录组 注释到的基因对应的氨基酸序列 使用需要评估的生物类别所属的数据库（从 busco 数据库下载）比对，得出比对上数据库的完整性比例的信息
BUSCO 官网 BUSCO v5 数据库 BUSCO 官网上介绍说可以直接使用 conda 安装，但据我实践，是不可以的，需要手动安装诸多依赖
安装 conda conda 的安装参考 Linux 下安装 conda
安装所需依赖 先创建一个 Python3.7 或 3.6 的环境
conda create -n busco python=3.7 激活刚刚创建的环境
conda activate busco 升级环境内的 pip 并且换源
python -m pip install -i https://pypi.tuna.tsinghua.edu.cn/simple --upgrade pip pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple 安装所需依赖</description></item><item><title>基因进化树的制作及其美化</title><link>https://yuanj.top/posts/8c3c2e59/</link><pubDate>Sat, 24 Jun 2023 22:17:51 +0000</pubDate><guid>https://yuanj.top/posts/8c3c2e59/</guid><description>Mega 默认导出的图片比较枯燥，并且展示的信息不够，本文讲述基因进化树的美化以及图片所展示的信息的一些处理
什么是进化树 系统发育进化树 (Phylogenetic tree)： 一般也叫系统进化树，进化树。它可以利用树状分支图形来表示各物种或基因间的亲缘关系。
分支系统发育分析 (Molecular phylogenetic analysis)： 是用来研究物种或序列进化和系统分类的一种方法。一般研究对象是碱基序列或氨基酸序列，通过数理统计算法来计算生物间进化关系。最后，根据计算结果，可视化为系统进化树
制作进化树 制作进化树的步骤参照视频 进化树分析
这里我着重讲一下美化的操作
导出进化树 美化 这里我使用的是 evolview 网站，先导入进化树，也就是我们刚刚保存的 nwk 的文件，项目名称随便写
先更改树的形状，一般大都是圆形，如果基因很多的话，圆形会比较好看也更加直观
下面我们主要调整的就是 import 这里这一排的选项
先给树叶加上背景色
生成一个颜色配置模板然后上传
默认的颜色是随机的，我们需要对配置文件进行一些改写，点击右边控制面板上的铅笔图标进行编辑
下面是配置文件的写法
Os01t4727000-01 yellow Os05t0568600-01 yellow Os05t0568800-01 yellow Os01t0639600-01 yellow Os05t0578100-01 yellow Os01t3976000-01 yellow Os05t0959000-01 blue Os02t0134200-01 blue Os07t0619500-01 blue Os02t0761300-00 blue Os06t0215100-01 red Os03t0303100-01 red Os11t0672900-01 red Os12t0556900-00 red 实际上就是基因与颜色对应，中间用一个制表符（按一下 tab 键）隔开，后面的 ad、prefix 这些不用管，直接删掉
而对于每个树叶，也就是基因名称的字体颜色与这个写法是一样的，我不再赘述
下面比较重要的一个就是对基因整体加上注释，也就是最外围一圈可以自定义一些分类名称什么的
我写的配置文件如下
##style 1 leaf_name text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed ##style 2-5 leaf_name bkcolor=#BE4144,text=mammal,textorientation=vertical,linewidth=4,fontsize=16 Os01t4727000-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568600-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568800-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t0639600-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0578100-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t3976000-01 text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0959000-01 text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0134200-01 text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os07t0619500-01 text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0761300-00 text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os06t0215100-01 text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os03t0303100-01 text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os11t0672900-01 text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os12t0556900-00 text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed 实际上与之前颜色的写法是差不多的，就是基因名称对应配置信息，text 就是显示的文字，color 是颜色，textorientation 控制字体水平还是垂直，linewidth、fontsize、linestyle 是控制字体和外围线条的尺寸和样式</description></item><item><title>TBtools 制作基因表达热图详解</title><link>https://yuanj.top/posts/81ccbfae/</link><pubDate>Fri, 23 Jun 2023 12:07:50 +0000</pubDate><guid>https://yuanj.top/posts/81ccbfae/</guid><description>使用 TBtools 制作基因表达热图实在是方便，美化起来也很简单，本文以水稻的一组基因为例，讲述基因表达数据的获取、处理并使用 TBtools 出图
数据准备 基因表达量数据一般由实验得来，对于一些物种也会有相对的数据库提供各种条件下实验得来的数据，我们课题组做的大都与水稻有关，我就以水稻的为例
RED 数据库提供了多数水稻基因在不同条件下的表达量数据，输入基因名称进行搜索，这里使用 RAP ID 或者 MUS ID 都可以，只不过貌似 RAP ID 的要全一点，很多 MUS ID 的都找不到
搜索完成后，这里有很多的 Project，每个 Project 对应不同的实验条件，例如 DRP000391 就是正常状况下的表达量
从 Project 的详情页的可以看到该项目的实验条件
点击Show Data然后导出数据，这里要注意一下，导出数据是需要 flash 支持的，但 21 年开始 chrome、edge 这些浏览器已经不支持 flash 了，可以使用 360 浏览器或者搜狗浏览器这些，我提供一个绿色版的 360 浏览器便携版，解压之后打开360chrome.exe直接使用
导出之后对数据进行处理，使用 Excel 的筛选功能，将数据整理成基因名称与各个项目的数据相对应的形式
对数据进行 Log2 处理，报错的值一律改为 0 即可
绘图 打开 TBtools 的 Heatmap 功能，把数据表格粘贴进去，start 出图
美化 默认的图颜色并不是很美观，我们可以对它进行调整点击 Show Control Dialog 打开控制面板，具体的参数注释如下
一般就是先对其进行聚类，然后调整颜色，我个人一般把 0.00 作为分界线改为白色，图形改为圆形，将上下限改为一样的数值，那么中心值自然就是 0.00 了</description></item><item><title>蛋白互作网络美化</title><link>https://yuanj.top/posts/2eef5da0/</link><pubDate>Thu, 22 Jun 2023 09:37:39 +0000</pubDate><guid>https://yuanj.top/posts/2eef5da0/</guid><description>String 数据库默认的图片并不是太美观，使用 Cytoscape 软件可以对其数据进行一些简单修改并对图片进行美化
软件安装 首先要安装 Cytoscape，而 Cytoscape 又需要 Java 环境，可以从下面的链接进行下载，先安装 Java，再安装 Cytoscape 即可
Java：https://www.123pan.com/s/JYtA-QeW0v.html
Cytoscape：https://www.123pan.com/s/JYtA-EeW0v.html
准备数据 数据还是来自于 String 数据库，获得蛋白互作网络之后，以 tsv 格式导出
进行美化 先将数据导入到软件中
我们可以先对每个蛋白的形状和字体进行一定的调整，点击左边栏的 style 选项卡，选择 node（node 就是蛋白，edge 就是蛋白之间的连接线），在 shape 栏中选择图形应用，一般的话都是圆形
选了圆形之后我们发现它变成了椭圆，这实际上是因为软件为了使图形与名称对应，在左侧调整图形的宽度和高度，两个值设为一样的数字就变成圆形了
高度和宽度的数值大小我们可以先改一个数字，后面把其它属性调整好之后再改
再来调整字体，点击左上方的 proerites，勾选 Label Font Face
点击 A 图标，选择字体后应用，一般我个人比较喜欢新罗马字体
现在再调整连接线，切换到 edge 选项卡
点击 width 这里第二个框，Column 选择 combined_score，Mapping Tyep 选择 Continuous Napping，可以看到右边的图形已经变化了，这是根据蛋白之间作用强度的关系来规定连接线的粗细，但是它貌似太粗了，我们可以调整一下上下限
双击左边的图形，在弹出的窗口中调整上下限，这时候就根据自身情况进行调整，怎么样好看怎么样来
我这个图中，蛋白的形状有点大，我将它调整小一点，然后把字体再放大一点
然后我们可以使用软件自带的一些布局调整蛋白的位置摆放，点击菜单栏中的 Layout，下面有一些可以选择的布局，可以自己调整着试一试
另外，这里还有一些样式可以参考，不过个人认为不是很好看，所以我就用默认的
我们还可以对形状的颜色、蛋白的名称进行调整
调整颜色在左边 Fill color 这一栏，第一个框内是对整体颜色进行调整
对单独几个蛋白的颜色进行调整的时候，按住 shift 键，再用鼠标左键可以多选蛋白，然后再 Fill color 第三个框内选择颜色确定即可</description></item><item><title>GO&amp;KEGG 富集分析</title><link>https://yuanj.top/posts/8db4bee4/</link><pubDate>Sat, 13 May 2023 17:49:08 +0000</pubDate><guid>https://yuanj.top/posts/8db4bee4/</guid><description>何为功能富集分析？ 功能富集分析是将基因或者蛋白列表分成多个部分，即将一堆基因进行分类，而这里的分类标准往往是按照基因的功能来限定的。换句话说，就是把一个基因列表中，具有相似功能的基因放到一起，并和生物学表型关联起来。
何为 GO 和 KEGG? 为了解决将基因按照功能进行分类的问题，科学家们开发了很多基因功能注释数据库。这其中比较有名的一个就是 Gene Ontology（基因本体论，GO）和 Kyoto Encyclopedia of Genes and Genomes（京都基因与基因组百科全书，KEGG）。
其中，GO 是基因本体论联合会建立的一个数据库，旨在建立一个适用于各种物种的、对基因和蛋白功能进行限定和描述的，并能随着研究不断深入而更新的语义词汇标准。GO 注释分为三大类，分别是：分子生物学功能（Molecular Function，MF）、生物学过程（Biological Process，BP）和细胞学组分（Cellular Components，CC），通过这三个功能大类，对一个基因的功能进行多方面的限定和描述。
而 KEGG，大多数听说过 KEGG 的人都会把它当做一个基因通路（Pathway）的数据库，其实人家的功能远不止于此。KEGG 是一个整合了基因组、化学和系统功能信息的综合数据库。KEGG 下属 4 个大类和 17 和子数据库，而其中有一个数据库叫做 KEGG Pathway，专门存储不同物种中基因通路的信息，也是用的最多的一个，所以，久而久之，KEGG 就被大家当做是一个通路数据库了
如何做功能富集分析？ 功能富集分析的算法有很多种，能够做功能富集分析的工具也非常多，如果大家想深入了解的话，下面是一个工具列表可供大家学习。
在以上所有的工具中，有一个工具是最为常用，也最为权威，那就是 DAVID，DAVID 是由美国 Leidos 生物医学研究公司的 LHRI 团队开发的一个在线基因注释及功能富集网站，其网址为 https://david.ncifcrf.gov 为什么说 DAVID 它是最权威的呢？看下图就知道了：仅 DAVID 这一个软件就发表了 10 篇 sci 文章，其中 5 分以上 7 篇，累计影响因子将近 85 分。其他用 DAVID 进行分析并发表的文章就更不计其数了
获取富集数据 打开 DAVID 官网：https://david.ncifcrf.gov/
点击上方功能菜单 Functional Annotation
选择上方的 upload 选项卡，在编辑框内粘贴基因 ID 列表，选 ID 类型为 ENSEMBL_GENE_ID ，选择列表类型为基因列表，最后上传列表</description></item><item><title>物种内共线性分析</title><link>https://yuanj.top/posts/f44e9fb8/</link><pubDate>Mon, 24 Apr 2023 17:26:51 +0000</pubDate><guid>https://yuanj.top/posts/f44e9fb8/</guid><description>概念 共线性是指同源基因在物种内或者物种之间的分布或排列关系。我们都知道，有相当多的基因在一个物种中不是以单拷贝的形式出现，而是多拷贝，具有基因序列重复事件，也就是说能行使相同功能的同源基因在同一个物种内可能不只有一条序列，而当我们想研究这些同源基因在同一个物种内的重复事件的时候，就是物种内的共线性分析。如果我们研究同源基因在不同物种内的分布情况，就是物种间的共线性分析，物种间可以是两个物种，也可以是多个物种。
共线性分析可以用 MCScanX 软件进行分析，但是这个软件的官网已经 404 了，而且利用命令行来进行分析比较麻烦，这里建议大家使用 TBtools 上的工具，这个软件里面集成了共线性分析的相关插件，并可以进行可视化操作，分析起来很方便。
原理 共线性分析最基本的原理是基于对基因序列进行 blast 比对，然后利用 MCScanX 软件对比对结果进行分析，这时候就需要有物种基因组的注释文件和比对结果，注释文件是用来分析这些基因所在的位置和数量，最后用可视化的软件把共线性分析的结果以图片形式展示出来。
所需工具及文件 TBtools 软件、物种基因组序列、注释文件
获取染色体长度文件 打开 TBtools 的 Fasta Stats 功能，导入物种基因组序列文件，设置好输出文件，获取染色体长度文件
将 chr len.txt 文件的内容粘贴到 Excel，只保留 ID 和 length 两列的数据，删除 chr len.txt 文件中原有的数据，将 ID 和 length 两列数据保存在 chr len.txt 中
共线性分析 打开 TBtools 的 One Step MCScanX 功能，这里它需要输入两个物种的基因组序列文件和注释文件，我们两个都导入拟南芥的进行物种内的共线性分析，这个过程中如果出现报错，关掉即可，不用理会
获得关联文件 打开 TBtools 的 Text Merge for MCScanX 功能，导入上一步分析结果（在输出目录中）中的 Collinearity 文件，将分析结果转换为 GenePairTable
打开 TBtools 的 Text Transformat for Micro-Synteny View 功能，导入上一步获得的 GenePairTable 文件和分析结果中的以。gff 为拓展名的文件（即简化后的注释文件），获得 LinkedRegion 文件，也就是基因间的关联文件 LinkedRegion</description></item><item><title>使用 HMMER 查找基因的同源序列</title><link>https://yuanj.top/posts/de3b1544/</link><pubDate>Sat, 22 Apr 2023 10:52:22 +0000</pubDate><guid>https://yuanj.top/posts/de3b1544/</guid><description>使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation &amp;amp; model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》
#创建 Python3.7 的虚拟环境 conda install -n bioinfo python=3.</description></item><item><title>顺式作用元件分析</title><link>https://yuanj.top/posts/6c282499/</link><pubDate>Wed, 29 Mar 2023 15:20:56 +0000</pubDate><guid>https://yuanj.top/posts/6c282499/</guid><description>概念 顺式作用元件 (cis-acting element) 存在于基因旁侧序列中能影响基因表达的序列
顺式作用元件包括启动子、增强子、调控序列和可诱导元件等，它们的作用是参与基因表达的调控。顺式作用元件本身不编码任何蛋白质，仅仅提供一个作用位点，要与反式作用因子相互作用而起作用
所需工具及文件 Gff3 注释文件、基因组全部序列、TBtools、plantcare 网站
提取启动子区域 首先要做的第一步是提取所有基因的 CDS 序列
提取时需要在初始化后将 TBtools 的设置改为如下配置
然后提取目标基因的启动子序列，打开 TBtools 的 Fasta Extract or Filter，设置好序列文件、输出文件、基因 ID，点击 start 开始
转换大小写 打开 Sequenxe Manipulate 工具，将提取出来的所有序列复制进去，全部转为大写
新建文本文档保存转换后的序列
上传至 plantcare 网站 现在需要打开网站 http://bioinformatics.psb.ugent.be/webtools/plantcare/html/ 将刚刚保存的序列上传进行顺势作用元件预测
等待一会后会收到网站发出的一封邮件，下载邮件中的附件然后解压，解压之后得到一个拓展名为 tar 的文件，再进行解压
整理网站返回信息 用 excel 打开解压出来的 tab 文件，此时 excel 中显示的就是这些基因的元件信息
筛选我们需要的物种，这里我选择了水稻
删除元件名称、元件序列、增减个数、加/减、物种等我们不需要的信息，然后为了保证最后的图片可看，这里需要扩大一下起始位置，较大的可以减少 20，较小的可以增大 20。并且需要将含有空白信息的项删除，不然 TBtools 会报错。最终整理成如下格式：
新建序列长度文件 下面需要再新建一个关于序列长度的文件，格式如下：
可视化 打开 TBtools 的 Simple BioSequence Viewer 功能，导入长度信息文件和元件信息，点击 start 开始
最终得到可视化结果</description></item></channel></rss>