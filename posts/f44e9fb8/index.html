<!doctype html><html lang=en><head><title>物种内共线性分析 · Uncle4</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="YuanJiao"><meta name=description content="概念 Link to heading 共线性是指同源基因在物种内或者物种之间的分布或排列关系。我们都知道，有相当多的基因在一个物种中不是以单拷贝的形式出现，而是多拷贝，具有基因序列重复事件，也就是说能行使相同功能的同源基因在同一个物种内可能不只有一条序列，而当我们想研究这些同源基因在同一个物种内的重复事件的时候，就是物种内的共线性分析。如果我们研究同源基因在不同物种内的分布情况，就是物种间的共线性分析，物种间可以是两个物种，也可以是多个物种。
共线性分析可以用 MCScanX 软件进行分析，但是这个软件的官网已经 404 了，而且利用命令行来进行分析比较麻烦，这里建议大家使用 TBtools 上的工具，这个软件里面集成了共线性分析的相关插件，并可以进行可视化操作，分析起来很方便。
原理 Link to heading 共线性分析最基本的原理是基于对基因序列进行 blast 比对，然后利用 MCScanX 软件对比对结果进行分析，这时候就需要有物种基因组的注释文件和比对结果，注释文件是用来分析这些基因所在的位置和数量，最后用可视化的软件把共线性分析的结果以图片形式展示出来。
所需工具及文件 Link to heading TBtools 软件、物种基因组序列、注释文件
获取染色体长度文件 Link to heading 打开 TBtools 的 Fasta Stats 功能，导入物种基因组序列文件，设置好输出文件，获取染色体长度文件
将 chr len.txt 文件的内容粘贴到 Excel，只保留 ID 和 length 两列的数据，删除 chr len.txt 文件中原有的数据，将 ID 和 length 两列数据保存在 chr len.txt 中
共线性分析 Link to heading 打开 TBtools 的 One Step MCScanX 功能，这里它需要输入两个物种的基因组序列文件和注释文件，我们两个都导入拟南芥的进行物种内的共线性分析，这个过程中如果出现报错，关掉即可，不用理会
获得关联文件 Link to heading 打开 TBtools 的 Text Merge for MCScanX 功能，导入上一步分析结果（在输出目录中）中的 Collinearity 文件，将分析结果转换为 GenePairTable"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="物种内共线性分析"><meta name=twitter:description content="概念 Link to heading 共线性是指同源基因在物种内或者物种之间的分布或排列关系。我们都知道，有相当多的基因在一个物种中不是以单拷贝的形式出现，而是多拷贝，具有基因序列重复事件，也就是说能行使相同功能的同源基因在同一个物种内可能不只有一条序列，而当我们想研究这些同源基因在同一个物种内的重复事件的时候，就是物种内的共线性分析。如果我们研究同源基因在不同物种内的分布情况，就是物种间的共线性分析，物种间可以是两个物种，也可以是多个物种。
共线性分析可以用 MCScanX 软件进行分析，但是这个软件的官网已经 404 了，而且利用命令行来进行分析比较麻烦，这里建议大家使用 TBtools 上的工具，这个软件里面集成了共线性分析的相关插件，并可以进行可视化操作，分析起来很方便。
原理 Link to heading 共线性分析最基本的原理是基于对基因序列进行 blast 比对，然后利用 MCScanX 软件对比对结果进行分析，这时候就需要有物种基因组的注释文件和比对结果，注释文件是用来分析这些基因所在的位置和数量，最后用可视化的软件把共线性分析的结果以图片形式展示出来。
所需工具及文件 Link to heading TBtools 软件、物种基因组序列、注释文件
获取染色体长度文件 Link to heading 打开 TBtools 的 Fasta Stats 功能，导入物种基因组序列文件，设置好输出文件，获取染色体长度文件
将 chr len.txt 文件的内容粘贴到 Excel，只保留 ID 和 length 两列的数据，删除 chr len.txt 文件中原有的数据，将 ID 和 length 两列数据保存在 chr len.txt 中
共线性分析 Link to heading 打开 TBtools 的 One Step MCScanX 功能，这里它需要输入两个物种的基因组序列文件和注释文件，我们两个都导入拟南芥的进行物种内的共线性分析，这个过程中如果出现报错，关掉即可，不用理会
获得关联文件 Link to heading 打开 TBtools 的 Text Merge for MCScanX 功能，导入上一步分析结果（在输出目录中）中的 Collinearity 文件，将分析结果转换为 GenePairTable"><meta property="og:title" content="物种内共线性分析"><meta property="og:description" content="概念 Link to heading 共线性是指同源基因在物种内或者物种之间的分布或排列关系。我们都知道，有相当多的基因在一个物种中不是以单拷贝的形式出现，而是多拷贝，具有基因序列重复事件，也就是说能行使相同功能的同源基因在同一个物种内可能不只有一条序列，而当我们想研究这些同源基因在同一个物种内的重复事件的时候，就是物种内的共线性分析。如果我们研究同源基因在不同物种内的分布情况，就是物种间的共线性分析，物种间可以是两个物种，也可以是多个物种。
共线性分析可以用 MCScanX 软件进行分析，但是这个软件的官网已经 404 了，而且利用命令行来进行分析比较麻烦，这里建议大家使用 TBtools 上的工具，这个软件里面集成了共线性分析的相关插件，并可以进行可视化操作，分析起来很方便。
原理 Link to heading 共线性分析最基本的原理是基于对基因序列进行 blast 比对，然后利用 MCScanX 软件对比对结果进行分析，这时候就需要有物种基因组的注释文件和比对结果，注释文件是用来分析这些基因所在的位置和数量，最后用可视化的软件把共线性分析的结果以图片形式展示出来。
所需工具及文件 Link to heading TBtools 软件、物种基因组序列、注释文件
获取染色体长度文件 Link to heading 打开 TBtools 的 Fasta Stats 功能，导入物种基因组序列文件，设置好输出文件，获取染色体长度文件
将 chr len.txt 文件的内容粘贴到 Excel，只保留 ID 和 length 两列的数据，删除 chr len.txt 文件中原有的数据，将 ID 和 length 两列数据保存在 chr len.txt 中
共线性分析 Link to heading 打开 TBtools 的 One Step MCScanX 功能，这里它需要输入两个物种的基因组序列文件和注释文件，我们两个都导入拟南芥的进行物种内的共线性分析，这个过程中如果出现报错，关掉即可，不用理会
获得关联文件 Link to heading 打开 TBtools 的 Text Merge for MCScanX 功能，导入上一步分析结果（在输出目录中）中的 Collinearity 文件，将分析结果转换为 GenePairTable"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/f44e9fb8/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-24T17:26:51+00:00"><meta property="article:modified_time" content="2023-04-24T17:26:51+00:00"><link rel=canonical href=https://yuanj.top/posts/f44e9fb8/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a839119b1aa7bfc3e0055cdab3ff54c50c8f3701d2041e2bf06daea11936adc3.css integrity="sha256-qDkRmxqnv8PgBVzas/9UxQyPNwHSBB4r8G2uoRk2rcM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/favicon.ico sizes=any><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Uncle4</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/essay/>Essay</a></li><li class=navigation-item><a class=navigation-link href=/gestbook/>Gestbook</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://yuanj.top/posts/f44e9fb8/>物种内共线性分析</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-04-24T17:26:51Z>April 24, 2023</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
One-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/bioinformatics/>Bioinformatics</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/tbtools/>TBtools</a></span></div></div></header><div class=post-content><h2 id=概念>概念
<a class=heading-link href=#%e6%a6%82%e5%bf%b5><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>共线性是指同源基因在物种内或者物种之间的分布或排列关系。我们都知道，有相当多的基因在一个物种中不是以单拷贝的形式出现，而是多拷贝，具有基因序列重复事件，也就是说能行使相同功能的同源基因在同一个物种内可能不只有一条序列，而当我们想研究这些同源基因在同一个物种内的重复事件的时候，就是物种内的共线性分析。如果我们研究同源基因在不同物种内的分布情况，就是物种间的共线性分析，物种间可以是两个物种，也可以是多个物种。</p><p>共线性分析可以用 MCScanX 软件进行分析，但是这个软件的官网已经 404 了，而且利用命令行来进行分析比较麻烦，这里建议大家使用 TBtools 上的工具，这个软件里面集成了共线性分析的相关插件，并可以进行可视化操作，分析起来很方便。</p><h2 id=原理>原理
<a class=heading-link href=#%e5%8e%9f%e7%90%86><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>共线性分析最基本的原理是基于对基因序列进行 blast 比对，然后利用 MCScanX 软件对比对结果进行分析，这时候就需要有物种基因组的注释文件和比对结果，注释文件是用来分析这些基因所在的位置和数量，最后用可视化的软件把共线性分析的结果以图片形式展示出来。</p><h2 id=所需工具及文件>所需工具及文件
<a class=heading-link href=#%e6%89%80%e9%9c%80%e5%b7%a5%e5%85%b7%e5%8f%8a%e6%96%87%e4%bb%b6><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>TBtools 软件、物种基因组序列、注释文件</p><h2 id=获取染色体长度文件>获取染色体长度文件
<a class=heading-link href=#%e8%8e%b7%e5%8f%96%e6%9f%93%e8%89%b2%e4%bd%93%e9%95%bf%e5%ba%a6%e6%96%87%e4%bb%b6><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>打开 TBtools 的 Fasta Stats 功能，导入物种基因组序列文件，设置好输出文件，获取染色体长度文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205457.png alt></p><p>将 chr len.txt 文件的内容粘贴到 Excel，只保留 ID 和 length 两列的数据，删除 chr len.txt 文件中原有的数据，将 ID 和 length 两列数据保存在 chr len.txt 中</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205539.png alt></p><h2 id=共线性分析>共线性分析
<a class=heading-link href=#%e5%85%b1%e7%ba%bf%e6%80%a7%e5%88%86%e6%9e%90><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>打开 TBtools 的 One Step MCScanX 功能，这里它需要输入两个物种的基因组序列文件和注释文件，我们两个都导入拟南芥的进行物种内的共线性分析，这个过程中如果出现报错，关掉即可，不用理会</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205555.png alt></p><h2 id=获得关联文件>获得关联文件
<a class=heading-link href=#%e8%8e%b7%e5%be%97%e5%85%b3%e8%81%94%e6%96%87%e4%bb%b6><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>打开 TBtools 的 Text Merge for MCScanX 功能，导入上一步分析结果（在输出目录中）中的 Collinearity 文件，将分析结果转换为 GenePairTable</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205623.png alt></p><p>打开 TBtools 的 Text Transformat for Micro-Synteny View 功能，导入上一步获得的 GenePairTable 文件和分析结果中的以。gff 为拓展名的文件（即简化后的注释文件），获得 LinkedRegion 文件，也就是基因间的关联文件 LinkedRegion</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205705.png alt></p><h2 id=可视化>可视化
<a class=heading-link href=#%e5%8f%af%e8%a7%86%e5%8c%96><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>打开 TBtools 的 Advanced Circos 功能，依次导入 chr len.txt、GenePairTable.txt、LinkedRegion.txt 进行绘图</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205736.png alt></p><p>这样就得到拟南芥所有基因的共线性分析 Circos 图了</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205755.png alt></p><h2 id=还没有结束>还没有结束
<a class=heading-link href=#%e8%bf%98%e6%b2%a1%e6%9c%89%e7%bb%93%e6%9d%9f><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>然而还没有结束，我们还需要突出显示出某些基因</p><p>我随便抽取一些基因，打开 TBtools 的 Text Block Extract and Filter 功能，从 GenePairTable 文件中获得这些基因的对应关系，生成新的 GenePairTable 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205834.png alt></p><p>然后生成新的关联文件 LinkedRegion</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205921.png alt></p><p>然后将新的 LinkedRegion.txt 文件的内容复制到 Excel 中，最后一列加上 RGB 色值</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424205932.png alt></p><p>随后将 Excel 中的内容合并到之前的 LinkedRegion.txt 文件中或者新建一个文本文件保存，如果不想显示全部基因的共线性，仅仅显示选中的这些基因的共线性的话，可以直接使用刚刚保存的带有 RGB 色值的 LinkedRegion.txt 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424210013.png alt></p><h2 id=还差一些东西>还差一些东西
<a class=heading-link href=#%e8%bf%98%e5%b7%ae%e4%b8%80%e4%ba%9b%e4%b8%9c%e8%a5%bf><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>我们似乎还需要显示出一些基因的名称，那就补充吧</p><p>打开 TBtools 的 Table Row Extract or Filter 功能，导入分析结果中简化的注释文件，在弹出的窗口中选择 ID 这一列，在输入框中再输入要展示的基因的 ID（注意名称要对应），这里是需要生成一个用于展示 ID 的新的 GenePairTable 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424210040.png alt></p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424210131.png alt></p><p>最后依次输入染色体长度文件、展示 ID 的 GenePairTable 文件、带有 RGB 色值的 LinkedRegion.txt 文件
绘图即可</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424210148.png alt></p><p>最终结果</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230424210204.png alt></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2023
YuanJiao</section></footer></main><script src=/js/coder.min.bf3def4cc889836d15cf3ab6357b9aaef07fabc3abf78b2a3b6eb00cd53c34e5.js integrity="sha256-vz3vTMiJg20Vzzq2NXuarvB/q8Or94sqO26wDNU8NOU="></script></body></html>