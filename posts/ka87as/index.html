<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="Yuan J 's blog"><meta name=description content="一般情况下，植物基因组 DNA 序列及注释文件可以在 ensembl 网站直接下载到，但蛋白质序列貌似不是很好下载，各处下载的序列文件格式、ID 等都有很大的不同，NCBI 上的也比较杂乱，所以还是自己翻译为好，这里依旧使用 TBtools
数据下载 其实在 ensembl 网站 可以下载到 DNA 序列、蛋白质序列及注释文件，但蛋白质序列的 ID 格式比较乱
我比较喜欢由 ID 直接对应序列的
先从 ensembl 网站 下载 DNA 序列及注释文件
打开 ensembl 网站 后，直接在首页的物种列表里选择物种，我们课题组主要做水稻，我就以水稻为例
点击物种详情页的 Download DNA sequence 就会跳转到 DNA 序列的 ftp 页面
以 dna.toplevel 结尾的就是基因组的全部 DNA 序列，其他的是各条染色体上的基因的 DNA 序列
回到详情页，点击 Gene annotation 下的 GFF3 下载注释文件
下载整个基因组的注释文件，而不是各条染色体的
再回到详情页，点击 Gene annotation 下的 FASTA
跳转到 ftp 页面之后我们可以看到这里有 DNA、ncrna、cDNA、CDS 及蛋白质（pep）
打开 pep 文件夹下载所有蛋白质序列
但这个蛋白质序列的 ID 很长，所以我们自己制备蛋白质序列"><meta property="og:title" content="植物基因组蛋白质序列的制备"><meta property="og:description" content="一般情况下，植物基因组 DNA 序列及注释文件可以在 ensembl 网站直接下载到，但蛋白质序列貌似不是很好下载，各处下载的序列文件格式、ID 等都有很大的不同，NCBI 上的也比较杂乱，所以还是自己翻译为好，这里依旧使用 TBtools
数据下载 其实在 ensembl 网站 可以下载到 DNA 序列、蛋白质序列及注释文件，但蛋白质序列的 ID 格式比较乱
我比较喜欢由 ID 直接对应序列的
先从 ensembl 网站 下载 DNA 序列及注释文件
打开 ensembl 网站 后，直接在首页的物种列表里选择物种，我们课题组主要做水稻，我就以水稻为例
点击物种详情页的 Download DNA sequence 就会跳转到 DNA 序列的 ftp 页面
以 dna.toplevel 结尾的就是基因组的全部 DNA 序列，其他的是各条染色体上的基因的 DNA 序列
回到详情页，点击 Gene annotation 下的 GFF3 下载注释文件
下载整个基因组的注释文件，而不是各条染色体的
再回到详情页，点击 Gene annotation 下的 FASTA
跳转到 ftp 页面之后我们可以看到这里有 DNA、ncrna、cDNA、CDS 及蛋白质（pep）
打开 pep 文件夹下载所有蛋白质序列
但这个蛋白质序列的 ID 很长，所以我们自己制备蛋白质序列"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/ka87as/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-18T17:59:26+08:00"><meta property="article:modified_time" content="2023-08-18T17:59:26+08:00"><title>植物基因组蛋白质序列的制备</title><link rel=canonical href=https://yuanj.top/posts/ka87as/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500"><link rel=stylesheet href="https://yuanj.top/css/reset.css?t=2023-10-06%2013%3a17%3a31.891991064%20%2b0000%20UTC%20m%3d%2b0.145199263"><link rel=stylesheet href="https://yuanj.top/css/pygments.css?t=2023-10-06%2013%3a17%3a31.891991064%20%2b0000%20UTC%20m%3d%2b0.145199263"><link rel=stylesheet href="https://yuanj.top/css/main.css?t=2023-10-06%2013%3a17%3a31.891991064%20%2b0000%20UTC%20m%3d%2b0.145199263"><link rel=stylesheet href="?t=2023-10-06%2013%3a17%3a31.891991064%20%2b0000%20UTC%20m%3d%2b0.145199263"><link rel="shortcut icon" href=https://yuanj.top/images/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=https://yuanj.top/><div class=name>Yuan J 's blog</div></a><h3 class=self-intro>Bioinformatics | HJLab @ CDUT | Chengdu</h3><nav><ul><li class=nav-posts><a href=https://yuanj.top/posts/><span>Posts</span></a></li><li class=nav-essay><a href=https://yuanj.top/essay/><span>Essay</span></a></li><li class=nav-about><a href=https://yuanj.top/about/><span>About</span></a></li></ul></nav></div></div></section><section class=icons><div class=container><div class=content><a href=//github.com/YuanJ2003 target=_blank rel=noopener><img class=icon src=https://yuanj.top/icons/github.svg alt=github></a>
<a href=https://yuanj.top/images/email.png target=_blank rel=noopener><img class=icon src=https://yuanj.top/icons/email.svg alt=email></a>
<a href=https://yuanj.top/images/wechat.jpg><img class=icon src=https://yuanj.top/icons/wechat.svg alt=wechat></a>
<a href="//space.bilibili.com/1692277850?spm_id_from=333.1007.0.0"><img class=icon src=https://yuanj.top/icons/bilibili.svg alt=bilibili></a>
<a href=https://yuanj.top/index.xml><img class=icon src=https://yuanj.top/icons/rss.svg alt=rss></a></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>植物基因组蛋白质序列的制备</div><div class=initials><a href=https://yuanj.top>ad</a></div></div><div class=meta><div class=date title='Fri Aug 18 2023 17:59:26 +0800'>Aug 18, 2023</div></div></div><div class=markdown><blockquote><p>一般情况下，植物基因组 DNA 序列及注释文件可以在 ensembl 网站直接下载到，但蛋白质序列貌似不是很好下载，各处下载的序列文件格式、ID 等都有很大的不同，NCBI 上的也比较杂乱，所以还是自己翻译为好，这里依旧使用 TBtools</p></blockquote><h2 id=数据下载>数据下载</h2><p>其实在 <a href=http://plants.ensembl.org/index.html>ensembl 网站</a> 可以下载到 DNA 序列、蛋白质序列及注释文件，但蛋白质序列的 ID 格式比较乱</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818180420.png alt></p><p>我比较喜欢由 ID 直接对应序列的</p><p>先从 <a href=http://plants.ensembl.org/index.html>ensembl 网站</a> 下载 DNA 序列及注释文件</p><p>打开 <a href=http://plants.ensembl.org/index.html>ensembl 网站</a> 后，直接在首页的物种列表里选择物种，我们课题组主要做水稻，我就以水稻为例</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818180627.png alt></p><p>点击物种详情页的 Download DNA sequence 就会跳转到 DNA 序列的 ftp 页面</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818180720.png alt></p><p>以 dna.toplevel 结尾的就是基因组的全部 DNA 序列，其他的是各条染色体上的基因的 DNA 序列</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818180841.png alt></p><p>回到详情页，点击 Gene annotation 下的 GFF3 下载注释文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818180841.png alt></p><p>下载整个基因组的注释文件，而不是各条染色体的</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818181037.png alt></p><p>再回到详情页，点击 Gene annotation 下的 FASTA</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818181222.png alt></p><p>跳转到 ftp 页面之后我们可以看到这里有 DNA、ncrna、cDNA、CDS 及蛋白质（pep）</p><p>打开 pep 文件夹下载所有蛋白质序列</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818181505.png alt></p><p>但这个蛋白质序列的 ID 很长，所以我们自己制备蛋白质序列</p><h2 id=蛋白质序列制备>蛋白质序列制备</h2><p>打开 TBtools 的 GTF Sequences Extract 工具，导入注释文件和 DNA 序列</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818181657.png alt></p><p>点击 Initalize 进行初始化，然后会弹出一个弹窗，关掉即可，Feature Tag 选择 CDS，Feature ID 选择 Parent，设置好输出文件后开始</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818181941.png alt></p><p>这里我们是为了提取 CDS 序列，为什么不直接下载呢？还是 ID 的原因&mldr; 下图可以自己看看</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818182205.png alt></p><blockquote><p>顺便解释一下这里选择标签的理由</p><p>初始化之后弹出的弹窗，事实上用户辅助用户选择 Feature Tag 和 Feature ID</p><p>Feature Tag，一般是 CDS, Exon, mRNA, Transcript, Gene 等，用户往往已经知道自己要提取什么，不需要辅助</p><p>Feature ID，以 CDS 和 mRNA 为例，我们很清楚，真核生物中，大多数基因均是断裂基因，即 Exon-Intron-Exon&mldr; CDS 即 Exon 的部分，所以 CDS 本身在基因序列的尺度上，也是被 Intron 所分隔，当我们需要提取 CDS 的时候，往往我们说的并不是提取 一截 CDS，而是把某个转录本对应的几截甚至几十截 CDS 按照正确的顺序和方向连接起来之后的真实的 CDS 全长</p><p>GFF3 注释文件中，同一个转录本拥有几截 CDS，这些 CDS 可以以 Parent 这个 Feature ID 来归组，并组合成的 CDS 全长，事实上，这个文件比较简单，因为 CDS 并没有更多的 Feature ID 可以选择，在其他物种中，常常会出现各种各种的 Feature ID，比如直接是 ID=</p><p>可以看到图片中还有 mRNA，在这个注释文件中，每一个 mRNA 基友 ID= 也有 Parent=，前者事实上是这个 mRNA 独有的标签，后者则记录了这个 mRNA 属于是哪一个基因的转录本之一，此时，如果是要提取这个 mRNA 的序列【包括 Exon 和 Intron】，那么设置 Feature ID 为 ID 则是正确的，如果选择 Feature ID 为 Parent，则只会得到不理想的结果，一个基因多个转录本会有完全相同的 Parent 便签，这些转录本会按顺序串联起来，这并不没有生物学意义</p></blockquote><p>等待一会提取完成后，我们先对提取的 CDS 序列文件进行一些处理</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818182650.png alt></p><p>可以看到其实序列对应的 ID 已经很简单了，但是还是有些不需要的，比如 transcript: 和后面的+ - ，使用 Notepad++或记事本之类的编辑器，全部替换为空</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818182727.png alt></p><p>现在就是最后一步了，使用 TBtools 的 Batch Translate CDS to Protein 工具把 CDS 翻译成蛋白质序列</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230818182831.png alt></p><br><div class=tags><strong>Tags:</strong>
<a href=https://yuanj.top/tags/bioinformatics>Bioinformatics</a>
<a href=https://yuanj.top/tags/tbtools>TBtools</a></div><br><p class=back-to-posts><a href=https://yuanj.top/posts>Back to posts</a></p></div><br><script src=https://giscus.app/client.js data-repo=YuanJ2003/YuanJ2003.github.io data-repo-id=R_kgDOKXKUsQ data-category=Announcements data-category-id=DIC_kwDOKXKUsc4CZj38 data-mapping=title data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></div></section><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js></script>
<script type=text/javascript>hljs.initHighlightingOnLoad()</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>