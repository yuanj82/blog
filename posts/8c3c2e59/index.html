<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="YuanJ2003"><meta name=description content="Mega 默认导出的图片比较枯燥，并且展示的信息不够，本文讲述基因进化树的美化以及图片所展示的信息的一些处理
什么是进化树 系统发育进化树 (Phylogenetic tree)： 一般也叫系统进化树，进化树。它可以利用树状分支图形来表示各物种或基因间的亲缘关系。
分支系统发育分析 (Molecular phylogenetic analysis)： 是用来研究物种或序列进化和系统分类的一种方法。一般研究对象是碱基序列或氨基酸序列，通过数理统计算法来计算生物间进化关系。最后，根据计算结果，可视化为系统进化树
制作进化树 制作进化树的步骤参照视频 进化树分析
这里我着重讲一下美化的操作
导出进化树 美化 这里我使用的是 evolview 网站，先导入进化树，也就是我们刚刚保存的 nwk 的文件，项目名称随便写
先更改树的形状，一般大都是圆形，如果基因很多的话，圆形会比较好看也更加直观
下面我们主要调整的就是 import 这里这一排的选项
先给树叶加上背景色
生成一个颜色配置模板然后上传
默认的颜色是随机的，我们需要对配置文件进行一些改写，点击右边控制面板上的铅笔图标进行编辑
下面是配置文件的写法
Os01t4727000-01	yellow Os05t0568600-01	yellow Os05t0568800-01	yellow Os01t0639600-01	yellow Os05t0578100-01	yellow Os01t3976000-01	yellow Os05t0959000-01	blue Os02t0134200-01	blue Os07t0619500-01	blue Os02t0761300-00	blue Os06t0215100-01	red Os03t0303100-01	red Os11t0672900-01	red Os12t0556900-00	red 实际上就是基因与颜色对应，中间用一个制表符（按一下 tab 键）隔开，后面的 ad、prefix 这些不用管，直接删掉
而对于每个树叶，也就是基因名称的字体颜色与这个写法是一样的，我不再赘述
下面比较重要的一个就是对基因整体加上注释，也就是最外围一圈可以自定义一些分类名称什么的
我写的配置文件如下
##style 1	leaf_name	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed ##style 2-5	leaf_name	bkcolor=#BE4144,text=mammal,textorientation=vertical,linewidth=4,fontsize=16 Os01t4727000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568800-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t0639600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0578100-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t3976000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0959000-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0134200-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os07t0619500-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0761300-00	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os06t0215100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os03t0303100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os11t0672900-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os12t0556900-00	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed 实际上与之前颜色的写法是差不多的，就是基因名称对应配置信息，text 就是显示的文字，color 是颜色，textorientation 控制字体水平还是垂直，linewidth、fontsize、linestyle 是控制字体和外围线条的尺寸和样式"><meta property="og:title" content="基因进化树的制作及其美化"><meta property="og:description" content="Mega 默认导出的图片比较枯燥，并且展示的信息不够，本文讲述基因进化树的美化以及图片所展示的信息的一些处理
什么是进化树 系统发育进化树 (Phylogenetic tree)： 一般也叫系统进化树，进化树。它可以利用树状分支图形来表示各物种或基因间的亲缘关系。
分支系统发育分析 (Molecular phylogenetic analysis)： 是用来研究物种或序列进化和系统分类的一种方法。一般研究对象是碱基序列或氨基酸序列，通过数理统计算法来计算生物间进化关系。最后，根据计算结果，可视化为系统进化树
制作进化树 制作进化树的步骤参照视频 进化树分析
这里我着重讲一下美化的操作
导出进化树 美化 这里我使用的是 evolview 网站，先导入进化树，也就是我们刚刚保存的 nwk 的文件，项目名称随便写
先更改树的形状，一般大都是圆形，如果基因很多的话，圆形会比较好看也更加直观
下面我们主要调整的就是 import 这里这一排的选项
先给树叶加上背景色
生成一个颜色配置模板然后上传
默认的颜色是随机的，我们需要对配置文件进行一些改写，点击右边控制面板上的铅笔图标进行编辑
下面是配置文件的写法
Os01t4727000-01	yellow Os05t0568600-01	yellow Os05t0568800-01	yellow Os01t0639600-01	yellow Os05t0578100-01	yellow Os01t3976000-01	yellow Os05t0959000-01	blue Os02t0134200-01	blue Os07t0619500-01	blue Os02t0761300-00	blue Os06t0215100-01	red Os03t0303100-01	red Os11t0672900-01	red Os12t0556900-00	red 实际上就是基因与颜色对应，中间用一个制表符（按一下 tab 键）隔开，后面的 ad、prefix 这些不用管，直接删掉
而对于每个树叶，也就是基因名称的字体颜色与这个写法是一样的，我不再赘述
下面比较重要的一个就是对基因整体加上注释，也就是最外围一圈可以自定义一些分类名称什么的
我写的配置文件如下
##style 1	leaf_name	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed ##style 2-5	leaf_name	bkcolor=#BE4144,text=mammal,textorientation=vertical,linewidth=4,fontsize=16 Os01t4727000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0568800-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t0639600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0578100-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os01t3976000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os05t0959000-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0134200-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os07t0619500-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os02t0761300-00	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os06t0215100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os03t0303100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os11t0672900-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed Os12t0556900-00	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed 实际上与之前颜色的写法是差不多的，就是基因名称对应配置信息，text 就是显示的文字，color 是颜色，textorientation 控制字体水平还是垂直，linewidth、fontsize、linestyle 是控制字体和外围线条的尺寸和样式"><meta property="og:type" content="article"><meta property="og:url" content="https://hieroglyphs.top/posts/8c3c2e59/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-24T22:17:51+00:00"><meta property="article:modified_time" content="2023-06-24T22:17:51+00:00"><title>基因进化树的制作及其美化</title><link rel=canonical href=https://hieroglyphs.top/posts/8c3c2e59/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500"><link rel=stylesheet href="https://hieroglyphs.top/css/reset.css?t=2023-10-04%2013%3a24%3a26.852756071%20%2b0000%20UTC%20m%3d%2b0.144209446"><link rel=stylesheet href="https://hieroglyphs.top/css/pygments.css?t=2023-10-04%2013%3a24%3a26.852756071%20%2b0000%20UTC%20m%3d%2b0.144209446"><link rel=stylesheet href="https://hieroglyphs.top/css/main.css?t=2023-10-04%2013%3a24%3a26.852756071%20%2b0000%20UTC%20m%3d%2b0.144209446"><link rel=stylesheet href="?t=2023-10-04%2013%3a24%3a26.852756071%20%2b0000%20UTC%20m%3d%2b0.144209446"><link rel="shortcut icon" href=https://hieroglyphs.top/images/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=https://hieroglyphs.top/><div class=name>YuanJ2003</div></a><h3 class=self-intro>Bioinformatics | HJLab @ CDUT | Chengdu</h3><nav><ul><li class=nav-posts><a href=https://hieroglyphs.top/posts/><span>Posts</span></a></li><li class=nav-diary><a href=https://hieroglyphs.top/diary/><span>Diary</span></a></li><li class=nav-about><a href=https://hieroglyphs.top/about/><span>About</span></a></li><li class=nav-gestbook><a href=https://hieroglyphs.top/gestbook/><span>Gestbook</span></a></li><li class=nav-links><a href=https://hieroglyphs.top/links/><span>Links</span></a></li></ul></nav></div></div></section><section class=icons><div class=container><div class=content><a href=//github.com/YuanJ2003 target=_blank rel=noopener><img class=icon src=https://hieroglyphs.top/icons/github.svg alt=github></a>
<a href=https://hieroglyphs.top/images/email.png target=_blank rel=noopener><img class=icon src=https://hieroglyphs.top/icons/email.svg alt=email></a>
<a href=https://hieroglyphs.top/images/wechat.jpg><img class=icon src=https://hieroglyphs.top/icons/wechat.svg alt=wechat></a>
<a href="//space.bilibili.com/1692277850?spm_id_from=333.1007.0.0"><img class=icon src=https://hieroglyphs.top/icons/bilibili.svg alt=bilibili></a>
<a href=https://hieroglyphs.top/index.xml><img class=icon src=https://hieroglyphs.top/icons/rss.svg alt=rss></a></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>基因进化树的制作及其美化</div><div class=initials><a href=https://hieroglyphs.top>ad</a></div></div><div class=meta><div class=date title='Sat Jun 24 2023 22:17:51 UTC'>Jun 24, 2023</div></div></div><div class=markdown><blockquote><p>Mega 默认导出的图片比较枯燥，并且展示的信息不够，本文讲述基因进化树的美化以及图片所展示的信息的一些处理</p></blockquote><h2 id=什么是进化树>什么是进化树</h2><p>系统发育进化树 (Phylogenetic tree)： 一般也叫系统进化树，进化树。它可以利用树状分支图形来表示各物种或基因间的亲缘关系。</p><p>分支系统发育分析 (Molecular phylogenetic analysis)： 是用来研究物种或序列进化和系统分类的一种方法。一般研究对象是碱基序列或氨基酸序列，通过数理统计算法来计算生物间进化关系。最后，根据计算结果，可视化为系统进化树</p><h2 id=制作进化树>制作进化树</h2><p>制作进化树的步骤参照视频 <a href="https://www.bilibili.com/video/BV1gs4y1N7ja/?vd_source=f785a7035a51b96b9abcf6b14d1036ea">进化树分析</a></p><p>这里我着重讲一下美化的操作</p><h2 id=导出进化树>导出进化树</h2><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624223655.png alt></p><h2 id=美化>美化</h2><p>这里我使用的是 <a href=http://www.evolgenius.info/evolview/>evolview 网站</a>，先导入进化树，也就是我们刚刚保存的 nwk 的文件，项目名称随便写</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224250.png alt></p><p>先更改树的形状，一般大都是圆形，如果基因很多的话，圆形会比较好看也更加直观</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224423.png alt></p><p>下面我们主要调整的就是 import 这里这一排的选项</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224507.png alt></p><p>先给树叶加上背景色</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224544.png alt></p><p>生成一个颜色配置模板然后上传</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224638.png alt></p><p>默认的颜色是随机的，我们需要对配置文件进行一些改写，点击右边控制面板上的铅笔图标进行编辑</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624224754.png alt></p><p>下面是配置文件的写法</p><pre tabindex=0><code>Os01t4727000-01	yellow
Os05t0568600-01	yellow
Os05t0568800-01	yellow
Os01t0639600-01	yellow
Os05t0578100-01	yellow
Os01t3976000-01	yellow
Os05t0959000-01	blue
Os02t0134200-01	blue
Os07t0619500-01	blue
Os02t0761300-00	blue
Os06t0215100-01	red
Os03t0303100-01	red
Os11t0672900-01	red
Os12t0556900-00	red
</code></pre><p>实际上就是基因与颜色对应，中间用一个制表符（按一下 tab 键）隔开，后面的 ad、prefix 这些不用管，直接删掉</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624225048.png alt></p><p>而对于每个树叶，也就是基因名称的字体颜色与这个写法是一样的，我不再赘述</p><p>下面比较重要的一个就是对基因整体加上注释，也就是最外围一圈可以自定义一些分类名称什么的</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624225640.png alt></p><p>我写的配置文件如下</p><pre tabindex=0><code>##style 1	leaf_name	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
##style 2-5	leaf_name	bkcolor=#BE4144,text=mammal,textorientation=vertical,linewidth=4,fontsize=16
Os01t4727000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os05t0568600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os05t0568800-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os01t0639600-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os05t0578100-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os01t3976000-01	text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os05t0959000-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os02t0134200-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os07t0619500-01	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os02t0761300-00	text=sub ii,color=blue,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os06t0215100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os03t0303100-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os11t0672900-01	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
Os12t0556900-00	text=sub iii,color=red,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
</code></pre><p>实际上与之前颜色的写法是差不多的，就是基因名称对应配置信息，text 就是显示的文字，color 是颜色，textorientation 控制字体水平还是垂直，linewidth、fontsize、linestyle 是控制字体和外围线条的尺寸和样式</p><pre tabindex=0><code>text=sub i,color=yellow,textorientation=vertical,linewidth=4,fontsize=16,linestyle=dashed
</code></pre><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624225942.png alt></p><p>不过这样每一个后面都显示分类或者家族的名称不太美观，所以我一般习惯把 text 全部留空，然后用 PPT 加上名称</p><p>到这里其实大部分也就没了，evolview 不能更改字体，所以也需要借助 PPT 来进行</p><p>这里还能给基因名称前添加一些形状，① 处是规则图形，如正方形、圆形等，② 处是一些小的图形</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624230526.png alt></p><p>下面是 ① 处的配置文件，也是基因名称对应形状和形状的颜色，可以添加多个图形</p><pre tabindex=0><code>##single decoration shape
##double decoration shapes seperated by tab space
##leaf_name	shape,fill_color
##leaf_name	shape,fill_color:border_color
Os01t4727000-01	star,white:red	triangle,white:green
Os05t0568600-01	rect,red	check,green
Os05t0568800-01	star,white:red	triangle,white:green
Os01t0639600-01	rect,red	check,green
Os05t0578100-01	rect,red	check,green
Os01t3976000-01	circle,white:green
Os05t0959000-01	star,red
Os02t0134200-01	star,red
Os07t0619500-01	rect,red	check,green
Os02t0761300-00	circle,white:green
Os06t0215100-01	circle,white:green
Os03t0303100-01	star,red
Os11t0672900-01	star,red
Os12t0556900-00	star,red
</code></pre><p>例如<code>star,red</code>就是一个红色的实心五角星，<code>triangle,white:green</code>是绿色边框、内部白色的三角形，可以对一些着重需要注意的基因加上图形进行标注</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624230927.png alt></p><p>② 处引入的是外链图标，也就是图标库的一些矢量图，可以从 <a href=https://www.tutorialspoint.com/index.htm>tutorialspoint</a> 网站上找，然后再 src 后面填上图标的外链</p><pre tabindex=0><code>Os01t4727000-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os05t0568600-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os05t0568800-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os01t0639600-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os05t0578100-01	src=
Os01t3976000-01	src=
Os05t0959000-01	src=
Os02t0134200-01	src=
Os07t0619500-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os02t0761300-00	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os06t0215100-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os03t0303100-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os11t0672900-01	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
Os12t0556900-00	src=https://www.tutorialspoint.com/videotutorials/images/coding_ground_home.jpg
</code></pre><p>个人认为这样有点过于花哨，并不是太美观</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624231316.png alt></p><p>下面这一项是对树枝颜色进行更改</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624231349.png alt></p><p>配置文件的写法和树叶的是一样的，基因名称对应颜色，可以直接把前面的配置文件拿来用</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624231552.png alt></p><h2 id=导出图像>导出图像</h2><p>导出图像可以用多种格式，svg 文件可以进行二次编辑，不过语法比较麻烦，我一般是放到 PPT 加上家族的分类名称</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624231659.png alt></p><h2 id=ppt-二次处理>PPT 二次处理</h2><p>使用 PPT 主要是加上亚家族的分类名称，再对照原先的进化树加上 bootstrap 值，bootstrap 值怎么来的我在视频里也讲了</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624231930.png alt></p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230624232226.png alt></p><br><p class=back-to-posts><a href=https://hieroglyphs.top/posts>Back to posts</a></p></div><br></div></div></section><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js></script>
<script type=text/javascript>hljs.initHighlightingOnLoad()</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>