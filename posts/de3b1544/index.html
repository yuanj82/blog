<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=author content="YuanJ 's Blog"><meta name=description content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation & model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》
#创建 Python3.7 的虚拟环境 conda install -n bioinfo python=3."><meta property="og:title" content="使用 HMMER 查找基因的同源序列"><meta property="og:description" content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation & model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》
#创建 Python3.7 的虚拟环境 conda install -n bioinfo python=3."><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/de3b1544/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-22T10:52:22+00:00"><meta property="article:modified_time" content="2023-04-22T10:52:22+00:00"><title>使用 HMMER 查找基因的同源序列</title><link rel=canonical href=https://yuanj.top/posts/de3b1544/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:500"><link rel=stylesheet href="https://yuanj.top/css/reset.css?t=2023-10-09%2005%3a51%3a26.03444742%20%2b0000%20UTC%20m%3d%2b0.115428512"><link rel=stylesheet href="https://yuanj.top/css/pygments.css?t=2023-10-09%2005%3a51%3a26.03444742%20%2b0000%20UTC%20m%3d%2b0.115428512"><link rel=stylesheet href="https://yuanj.top/css/main.css?t=2023-10-09%2005%3a51%3a26.03444742%20%2b0000%20UTC%20m%3d%2b0.115428512"><link rel=stylesheet href="?t=2023-10-09%2005%3a51%3a26.03444742%20%2b0000%20UTC%20m%3d%2b0.115428512"><link rel="shortcut icon" href=https://yuanj.top/images/favicon.ico></head><body lang=en><section class=header><div class=container><div class=content><a href=https://yuanj.top/><div class=name>YuanJ 's Blog</div></a><h3 class=self-intro>Bioinformatics | HJLab @ CDUT | Chengdu</h3><nav><ul><li class=nav-posts><a href=https://yuanj.top/posts/><span>Posts</span></a></li><li class=nav-essay><a href=https://yuanj.top/essay/><span>Essay</span></a></li><li class=nav-music><a href=https://yuanj.top/music/><span>Music</span></a></li><li class=nav-about><a href=https://yuanj.top/about/><span>About</span></a></li></ul></nav></div></div></section><section class=icons><div class=container><div class=content><a href=//github.com/YuanJ2003 target=_blank rel=noopener><img class=icon src=https://yuanj.top/icons/github.svg alt=github></a>
<a href=https://yuanj.top/images/email.png target=_blank rel=noopener><img class=icon src=https://yuanj.top/icons/email.svg alt=email></a>
<a href=https://yuanj.top/images/wechat.jpg><img class=icon src=https://yuanj.top/icons/wechat.svg alt=wechat></a>
<a href="//space.bilibili.com/1692277850?spm_id_from=333.1007.0.0"><img class=icon src=https://yuanj.top/icons/bilibili.svg alt=bilibili></a>
<a href=https://yuanj.top/index.xml><img class=icon src=https://yuanj.top/icons/rss.svg alt=rss></a></div></div></section><section class="main post non-narrow zero-top-spacing"><div class=container><div class=content><div class=front-matter><div class=title-container><div class=page-heading>使用 HMMER 查找基因的同源序列</div><div class=initials><a href=https://yuanj.top>ad</a></div></div><div class=meta><div class=date title='Sat Apr 22 2023 10:52:22 UTC'>Apr 22, 2023</div></div></div><div class=markdown><blockquote><p>使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作</p></blockquote><h2 id=hmmer>HMMER</h2><p>HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确</p><p>从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及</p><h2 id=所需工具>所需工具</h2><p>Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）</p><h2 id=下载隐马尔科夫模型>下载隐马尔科夫模型</h2><p>我以拟南芥的 SBP 家族为例
打开 <a href=http://pfam-legacy.xfam.org/>pfam</a>，输入基因家族的 pf 号点击 go 进行查询</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214309.png alt></p><p>也可以通过查询关键字来查找</p><p>查询到之后，点击左边的 Curation & model 下载 hmm 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214325.png alt></p><p>再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214336.png alt></p><h2 id=安装-hmmer>安装 HMMER</h2><p>在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 <a href=https://www.hieroglyphs.top/2023/05/01/linux2/>《Linux 下安装 conda》</a></p><pre tabindex=0><code>#创建 Python3.7 的虚拟环境
conda install -n bioinfo python=3.7

#激活虚拟环境
conda activate bioinfo

#安装 hmmer
conda install hmmer
</code></pre><h2 id=构建-hmm-模型>构建 hmm 模型</h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmbuild [xxx.hmm] [xxx.txt] #构建 hmm 模型（使用我们再 pfam 网站下载的 hmm 文件和 txt 文件，要保证文件都在同一工作目录下
</code></pre><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214418.png alt></p><h2 id=进行比对>进行比对</h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmsearch [hmm 文件] [待比对物种 fasta 文件] &gt; [输出文件名]  

#输出文件名以。out 结尾
#fasta 文件即整个物种的氨基酸序列 (fasta 文件名的缩写为 fa)
</code></pre><p>比对完成之后使用 cat 命令查看比对的结果</p><pre tabindex=0><code>cat result.out
</code></pre><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214437.png alt></p><h2 id=进一步筛选>进一步筛选</h2><p>随后我们可以通过各种数据库如 NCBI、TBtools 的比对工具等，进行进一步筛选，并用 MEME、CD-Search 进一步鉴定，排除“假阳性“。</p><br><div class=tags><strong>Tags:</strong>
<a href=https://yuanj.top/tags/bioinformatics>Bioinformatics</a>
<a href=https://yuanj.top/tags/hmmer>HMMER</a></div><br><p class=back-to-posts><a href=https://yuanj.top/posts>Back to posts</a></p></div><br><script src=https://giscus.app/client.js data-repo=YuanJ2003/YuanJ2003.github.io data-repo-id=R_kgDOKXKUsQ data-category=Announcements data-category-id=DIC_kwDOKXKUsc4CZj38 data-mapping=title data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></div></section><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js></script>
<script type=text/javascript>hljs.initHighlightingOnLoad()</script><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style></body></html>