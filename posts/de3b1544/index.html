<!doctype html><html lang=en><head><title>使用 HMMER 查找基因的同源序列 · Uncle4</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="YuanJiao"><meta name=description content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER Link to heading HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Link to heading Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 Link to heading 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation & model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER Link to heading 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="使用 HMMER 查找基因的同源序列"><meta name=twitter:description content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER Link to heading HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Link to heading Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 Link to heading 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation & model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER Link to heading 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》"><meta property="og:title" content="使用 HMMER 查找基因的同源序列"><meta property="og:description" content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作
HMMER Link to heading HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确
从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及
所需工具 Link to heading Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）
下载隐马尔科夫模型 Link to heading 我以拟南芥的 SBP 家族为例 打开 pfam，输入基因家族的 pf 号点击 go 进行查询
也可以通过查询关键字来查找
查询到之后，点击左边的 Curation & model 下载 hmm 文件
再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件
安装 HMMER Link to heading 在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 《Linux 下安装 conda》"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/de3b1544/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-22T10:52:22+00:00"><meta property="article:modified_time" content="2023-04-22T10:52:22+00:00"><link rel=canonical href=https://yuanj.top/posts/de3b1544/><link rel=preload href="/fonts/forkawesome-webfont.woff2?v=1.2.0" as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.a839119b1aa7bfc3e0055cdab3ff54c50c8f3701d2041e2bf06daea11936adc3.css integrity="sha256-qDkRmxqnv8PgBVzas/9UxQyPNwHSBB4r8G2uoRk2rcM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=/>Uncle4</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Posts</a></li><li class=navigation-item><a class=navigation-link href=/essay/>Essay</a></li><li class=navigation-item><a class=navigation-link href=/gestbook/>Gestbook</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://yuanj.top/posts/de3b1544/>使用 HMMER 查找基因的同源序列</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i>
<time datetime=2023-04-22T10:52:22Z>April 22, 2023</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>
One-minute read</span></div><div class=tags><i class="fa fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/bioinformatics/>Bioinformatics</a></span>
<span class=separator>•</span>
<span class=tag><a href=/tags/hmmer/>HMMER</a></span></div></div></header><div class=post-content><blockquote><p>使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作</p></blockquote><h2 id=hmmer>HMMER
<a class=heading-link href=#hmmer><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确</p><p>从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及</p><h2 id=所需工具>所需工具
<a class=heading-link href=#%e6%89%80%e9%9c%80%e5%b7%a5%e5%85%b7><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）</p><h2 id=下载隐马尔科夫模型>下载隐马尔科夫模型
<a class=heading-link href=#%e4%b8%8b%e8%bd%bd%e9%9a%90%e9%a9%ac%e5%b0%94%e7%a7%91%e5%a4%ab%e6%a8%a1%e5%9e%8b><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>我以拟南芥的 SBP 家族为例
打开 <a href=http://pfam-legacy.xfam.org/ class=external-link target=_blank rel=noopener>pfam</a>，输入基因家族的 pf 号点击 go 进行查询</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214309.png alt></p><p>也可以通过查询关键字来查找</p><p>查询到之后，点击左边的 Curation & model 下载 hmm 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214325.png alt></p><p>再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件</p><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214336.png alt></p><h2 id=安装-hmmer>安装 HMMER
<a class=heading-link href=#%e5%ae%89%e8%a3%85-hmmer><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 <a href=https://www.hieroglyphs.top/2023/05/01/linux2/ class=external-link target=_blank rel=noopener>《Linux 下安装 conda》</a></p><pre tabindex=0><code>#创建 Python3.7 的虚拟环境
conda install -n bioinfo python=3.7

#激活虚拟环境
conda activate bioinfo

#安装 hmmer
conda install hmmer
</code></pre><h2 id=构建-hmm-模型>构建 hmm 模型
<a class=heading-link href=#%e6%9e%84%e5%bb%ba-hmm-%e6%a8%a1%e5%9e%8b><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmbuild [xxx.hmm] [xxx.txt] #构建 hmm 模型（使用我们再 pfam 网站下载的 hmm 文件和 txt 文件，要保证文件都在同一工作目录下
</code></pre><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214418.png alt></p><h2 id=进行比对>进行比对
<a class=heading-link href=#%e8%bf%9b%e8%a1%8c%e6%af%94%e5%af%b9><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmsearch [hmm 文件] [待比对物种 fasta 文件] &gt; [输出文件名]  

#输出文件名以。out 结尾
#fasta 文件即整个物种的氨基酸序列 (fasta 文件名的缩写为 fa)
</code></pre><p>比对完成之后使用 cat 命令查看比对的结果</p><pre tabindex=0><code>cat result.out
</code></pre><p><img src=https://jihulab.com/YuanJ2003/static/-/raw/main/blog-images/20230422214437.png alt></p><h2 id=进一步筛选>进一步筛选
<a class=heading-link href=#%e8%bf%9b%e4%b8%80%e6%ad%a5%e7%ad%9b%e9%80%89><i class="fa fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>随后我们可以通过各种数据库如 NCBI、TBtools 的比对工具等，进行进一步筛选，并用 MEME、CD-Search 进一步鉴定，排除“假阳性“。</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2023
YuanJiao</section></footer></main><script src=/js/coder.min.bf3def4cc889836d15cf3ab6357b9aaef07fabc3abf78b2a3b6eb00cd53c34e5.js integrity="sha256-vz3vTMiJg20Vzzq2NXuarvB/q8Or94sqO26wDNU8NOU="></script></body></html>