<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>使用 HMMER 查找基因的同源序列 - 猫四叔</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="使用 HMMER 查找基因的同源序列"><meta property="og:description" content="使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/de3b1544/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-22T10:52:22+00:00"><meta property="article:modified_time" content="2023-04-22T10:52:22+00:00"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=猫四叔 rel=home><div class="logo__item logo__text"><div class=logo__title>猫四叔</div><div class=logo__tagline>思绪来得快去得也快，偶尔会在这里停留</div></div></a></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>使用 HMMER 查找基因的同源序列</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2023-04-22T10:52:22Z>April 22, 2023</time></div></div></header><div class="content post__content clearfix"><p>使用 HMMER 查找同源基因比 blast 更加准确，速度也更快，但使用方法很少有文章讲清楚，本文记录我使用 HMMER 的操作</p><h2 id=hmmer>HMMER</h2><p>HMMER 是基于隐马尔可夫模型，用于生物序列分析工作的一个非常强大的软件包，它的一般用途是识别同源蛋白或核苷酸序列和进行序列比对。与 BLAST、FASTA 等序列比对和数据库搜索工具相比，HMMER 更准确</p><p>从功能基因研究的角度来讲，相关的搜索，比如从序列数据库中，找同源的序列，或者对一个新的基因功能进行鉴定，使用 HMMER 比使用 blast 有着更高的灵敏度以及更高的搜索速度，但其应用远没有 blast 普及</p><h2 id=所需工具>所需工具</h2><p>Linux 系统环境、HMMER 软件、pfam 网站（http://pfam-legacy.xfam.org/）</p><h2 id=下载隐马尔科夫模型>下载隐马尔科夫模型</h2><p>我以拟南芥的 SBP 家族为例
打开 <a href=http://pfam-legacy.xfam.org/>pfam</a>，输入基因家族的 pf 号点击 go 进行查询</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230422214309.png alt></p><p>也可以通过查询关键字来查找</p><p>查询到之后，点击左边的 Curation & model 下载 hmm 文件</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230422214325.png alt></p><p>再点击 Alignments 选择 stockholm，点击 gengerate 后会自动下载一个 txt 文件</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230422214336.png alt></p><h2 id=安装-hmmer>安装 HMMER</h2><p>在 Linux 系统环境下，推荐使用 conda 安装 HMMER，conda 的安装配置教程请参照此文章 <a href=https://www.hieroglyphs.top/2023/05/01/linux2/>《Linux 下安装 conda》</a></p><pre tabindex=0><code>#创建 Python3.7 的虚拟环境
conda install -n bioinfo python=3.7

#激活虚拟环境
conda activate bioinfo

#安装 hmmer
conda install hmmer
</code></pre><h2 id=构建-hmm-模型>构建 hmm 模型</h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmbuild [xxx.hmm] [xxx.txt] #构建 hmm 模型（使用我们再 pfam 网站下载的 hmm 文件和 txt 文件，要保证文件都在同一工作目录下
</code></pre><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230422214418.png alt></p><h2 id=进行比对>进行比对</h2><p>在工作目录下执行命令</p><pre tabindex=0><code>hmmsearch [hmm 文件] [待比对物种 fasta 文件] &gt; [输出文件名]  

#输出文件名以。out 结尾
#fasta 文件即整个物种的氨基酸序列 (fasta 文件名的缩写为 fa)
</code></pre><p>比对完成之后使用 cat 命令查看比对的结果</p><pre tabindex=0><code>cat result.out
</code></pre><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230422214437.png alt></p><h2 id=进一步筛选>进一步筛选</h2><p>随后我们可以通过各种数据库如 NCBI、TBtools 的比对工具等，进行进一步筛选，并用 MEME、CD-Search 进一步鉴定，排除“假阳性“。</p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/posts/6c282499/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>顺式作用元件分析</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/posts/f44e9fb8/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>物种内共线性分析</p></a></div></nav></div></div></div><script async defer src=/js/menu.js></script></body></html>