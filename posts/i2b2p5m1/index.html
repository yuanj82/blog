<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>DESeq2 差异表达分析 - 猫四叔</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="DESeq2 差异表达分析"><meta property="og:description" content="还是之前拿到的转录组数据，只有表达量矩阵是不行的，作为 RNA-seq 下游分析重要的一步，差异表达分析将不同处理下的基因表达数据同对照组做统计分析，筛选出具有显著表达变化的基因集，这一步对后面的研究是很有必要的。"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/i2b2p5m1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-24T21:56:13+08:00"><meta property="article:modified_time" content="2023-11-24T21:56:13+08:00"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css></head><body class=body><div class="container container--outer"><header class=header><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><div class="container header__container"><div class=logo><a class=logo__link href=/ title=猫四叔 rel=home><div class="logo__item logo__text"><div class=logo__title>猫四叔</div><div class=logo__tagline>思绪来得快去得也快，偶尔会在这里停留</div></div></a></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>DESeq2 差异表达分析</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><time class=meta__text datetime=2023-11-24T21:56:13+08:00>November 24, 2023</time></div></div><div class=post_busuanzi><p>本文总阅读量 <span id=busuanzi_value_page_pv></span> 次</p></div></header><div class="content post__content clearfix"><p>还是之前拿到的转录组数据，只有表达量矩阵是不行的，作为 RNA-seq 下游分析重要的一步，差异表达分析将不同处理下的基因表达数据同对照组做统计分析，筛选出具有显著表达变化的基因集，这一步对后面的研究是很有必要的。</p><p>首先加载 R 包：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>library</span>(DESeq2)
</span></span></code></pre></div><p>读入表达矩阵，以基因 ID 为行名：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>counts <span style=color:#f92672>=</span> <span style=color:#a6e22e>read.csv</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;gene2.counts&#39;</span>, 
</span></span><span style=display:flex><span>    header <span style=color:#f92672>=</span> T,  
</span></span><span style=display:flex><span>    sep <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\t&#39;</span>, 
</span></span><span style=display:flex><span>    row.names <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Geneid&#34;</span>, 
</span></span><span style=display:flex><span>    comment.char <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;#&#39;</span>, 
</span></span><span style=display:flex><span>    check.name <span style=color:#f92672>=</span> F
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>我这里拿到的表达矩阵的数据格式是这样的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span># Program:featureCounts v2.0.6; Command:&#34;featureCounts&#34; &#34;-T&#34; &#34;5&#34; &#34;-t&#34; &#34;exon&#34; &#34;-g&#34; &#34;Name&#34; &#34;-a&#34; &#34;Lolium_perenne.gff3&#34; &#34;-o&#34; &#34;gene.counts&#34; &#34;-p&#34; &#34;C0_1&#34; &#34;C0_2&#34; &#34;C0_3&#34; &#34;C50_1&#34; &#34;C50_2&#34; &#34;C50_3&#34; &#34;C500_1&#34; &#34;C500_2&#34; &#34;C500_3&#34; 														
</span></span><span style=display:flex><span>Geneid	Chr	Start	End	Strand	Length	C0_1	C0_2	C0_3	C50_1	C50_2	C50_3	C500_1	C500_2	C500_3
</span></span><span style=display:flex><span>KYUSt_chr1.5-E1	1	53340	53891	+	552	233	146	195	201	189	264	177	326	243
</span></span><span style=display:flex><span>KYUSt_chr1.6-E1	1	54648	55664	-	1017	2	4	8	12	6	3	20	47	17
</span></span><span style=display:flex><span>KYUSt_chr1.7-E1	1	59936	60283	+	348	3	0	6	7	0	0	1	0	0
</span></span><span style=display:flex><span>KYUSt_chr1.8-E1	1	61782	61841	+	60	0	0	0	0	0	0	2	0	0
</span></span><span style=display:flex><span>KYUSt_chr1.8-E2	1	62373	62621	+	249	9	21	81	34	17	8	57	12	9
</span></span><span style=display:flex><span>KYUSt_chr1.9-E1	1	63456	63489	+	34	0	0	0	0	0	0	0	0	0
</span></span><span style=display:flex><span>KYUSt_chr1.9-E2	1	63904	63983	+	80	0	0	0	0	0	0	0	0	0
</span></span><span style=display:flex><span>KYUSt_chr1.9-E3	1	64100	64177	+	78	0	0	0	0	0	0	0	0	0
</span></span><span style=display:flex><span>KYUSt_chr1.9-E4	1	64286	64361	+	76	0	0	0	0	0	0	0	0	0
</span></span></code></pre></div><p>对数据要先进行一些预处理，比如删掉前五行不需要的数据：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>counts <span style=color:#f92672>=</span> counts[,<span style=color:#f92672>-</span><span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>)]
</span></span></code></pre></div><p>我的这个数据里面有很多表达量很低或者都是 0 的，这种数据自然是直接删掉为好，只保留相加大于 10 的数据：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>counts <span style=color:#f92672>=</span> counts<span style=color:#a6e22e>[rowSums</span>(counts)<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>10</span>, ]
</span></span></code></pre></div><p>创建样本信息数据框：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>samples <span style=color:#f92672>=</span> <span style=color:#a6e22e>data.frame</span>(
</span></span><span style=display:flex><span>    sampleID <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;C0_1&#34;</span>, <span style=color:#e6db74>&#34;C0_2&#34;</span>, <span style=color:#e6db74>&#34;C0_3&#34;</span>, <span style=color:#e6db74>&#34;C50_1&#34;</span>, <span style=color:#e6db74>&#34;C50_2&#34;</span>, <span style=color:#e6db74>&#34;C50_3&#34;</span>, <span style=color:#e6db74>&#34;C500_1&#34;</span>, <span style=color:#e6db74>&#34;C500_2&#34;</span>, <span style=color:#e6db74>&#34;C500_3&#34;</span>), 
</span></span><span style=display:flex><span>    sample <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;sample1&#34;</span>, <span style=color:#e6db74>&#34;sample1&#34;</span>, <span style=color:#e6db74>&#34;sample1&#34;</span>, <span style=color:#e6db74>&#34;sample2&#34;</span>, <span style=color:#e6db74>&#34;sample2&#34;</span>, <span style=color:#e6db74>&#34;sample2&#34;</span>, <span style=color:#e6db74>&#34;sample3&#34;</span>, <span style=color:#e6db74>&#34;sample3&#34;</span>, <span style=color:#e6db74>&#34;sample3&#34;</span>)
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><p>按照 sampleID 更改 samples 的行名：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>rownames</span>(samples) <span style=color:#f92672>=</span> samples<span style=color:#f92672>$</span>sampleID
</span></span></code></pre></div><p>将样本类型列转换为因子型数据，并设定默认排序为 1=sample1, 2=sample2, 3=sample3：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>samples<span style=color:#f92672>$</span>sample <span style=color:#f92672>=</span> <span style=color:#a6e22e>factor</span>(samples<span style=color:#f92672>$</span>sample, levels <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#39;sample1&#39;</span>, <span style=color:#e6db74>&#39;sample2&#39;</span>, <span style=color:#e6db74>&#39;sample3&#39;</span>))
</span></span></code></pre></div><p>将读入的基因表达矩阵和样本信息构建为 DESeqDataSet 对象，使 DESeq2 包可读：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>dds <span style=color:#f92672>=</span> <span style=color:#a6e22e>DESeqDataSetFromMatrix</span>(countData <span style=color:#f92672>=</span> counts, colData <span style=color:#f92672>=</span> samples, design <span style=color:#f92672>=</span> <span style=color:#f92672>~</span>sample)
</span></span></code></pre></div><p>进行差异分析，计算差异倍数和 p 值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>dds_count <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>DESeq</span>(dds, fitType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;mean&#39;</span>, minReplicatesForReplace <span style=color:#f92672>=</span> <span style=color:#ae81ff>7</span>, parallel <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span></code></pre></div><ul><li>fitType = &lsquo;mean&rsquo; 表示使用均值作为拟合模型</li><li>minReplicatesForReplace = 7 表示在进行差异分析时，至少需要 7 个样本</li><li>parallel = FALSE 表示不使用多线程运行</li></ul><p>因为我这里有三组样本，分别是 C0、C50、C500，于是分为两组进行计算：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>sampl1_vs_sample2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>results</span>(dds_count, contrast <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#39;sample&#39;</span>, <span style=color:#e6db74>&#39;sample1&#39;</span>, <span style=color:#e6db74>&#39;sample2&#39;</span>))
</span></span><span style=display:flex><span>sampl1_vs_sample3 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>results</span>(dds_count, contrast <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#39;sample&#39;</span>, <span style=color:#e6db74>&#39;sample2&#39;</span>, <span style=color:#e6db74>&#39;sample3&#39;</span>))
</span></span></code></pre></div><p>最后将两组结果转为数据框并且写入文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>result1 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(sampl1_vs_sample2, stringsAsFactors <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, check.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>result2 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(sampl1_vs_sample3, stringsAsFactors <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>, check.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>write.table</span>(result1, <span style=color:#e6db74>&#39;sampl1_vs_sample2.DESeq2.txt&#39;</span>, col.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>NA</span>, sep <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\t&#39;</span>, quote <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>write.table</span>(result2, <span style=color:#e6db74>&#39;sampl1_vs_sample3.DESeq2.txt&#39;</span>, col.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>NA</span>, sep <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;\t&#39;</span>, quote <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span></code></pre></div><p>最后得到的数据格式如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>	baseMean	log2FoldChange	lfcSE	stat	pvalue	padj
</span></span><span style=display:flex><span>KYUSt_chr1.5-E1	213.082745455399	-0.159514113054599	0.32122397700057	-0.496582212025585	0.619483699498433	1
</span></span><span style=display:flex><span>KYUSt_chr1.6-E1	12.858979620238	-0.583646140965058	0.84821388423366	-0.688088407668978	0.491397110057002	1
</span></span><span style=display:flex><span>KYUSt_chr1.7-E1	1.93773722098783	0.307122539555924	2.44861358460283	0.125427115771613	0.900185422338187	NA
</span></span><span style=display:flex><span>KYUSt_chr1.8-E2	27.843256050414	0.92386601716311	1.12261950538863	0.822955607602139	0.41053323848971	0.993851867813233
</span></span><span style=display:flex><span>KYUSt_chr1.107-E3	9624.18154923748	1.2105461981764	0.753264345021032	1.60706690311036	0.108039692660408	0.826100628829101
</span></span><span style=display:flex><span>KYUSt_chr1.107-E2	5756.42276327944	0.282255247362519	0.52083207523245	0.541931384000394	0.587865775653251	1
</span></span><span style=display:flex><span>KYUSt_chr1.107-E1	6541.69156640286	0.396931212730972	0.672807064222869	0.589962908890457	0.555215516638021	1
</span></span><span style=display:flex><span>KYUSt_chr1.117-E1	87.1271890512162	0.356042837051628	0.492560961499353	0.722840145446841	0.469778099923088	1
</span></span></code></pre></div><p>然后使用 ggplot2 包绘制火山图：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.table</span>(<span style=color:#e6db74>&#39;./sampl1_vs_sample2.DESeq2.txt&#39;</span>, header <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(data)
</span></span></code></pre></div><p>设置 pvalue 和 logFC 的阈值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>cut_off_pvalue <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.0000001</span>
</span></span><span style=display:flex><span>cut_off_logFC <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>据阈值分为上调基因 down 和下调基因 down，无差异基因为 stable，并保存到 change 列：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>data<span style=color:#f92672>$</span>change <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ifelse </span>(
</span></span><span style=display:flex><span>    data<span style=color:#f92672>$</span>pvalue <span style=color:#f92672>&lt;</span> cut_off_pvalue <span style=color:#f92672>&amp;</span> <span style=color:#a6e22e>abs</span>(data<span style=color:#f92672>$</span>log2FoldChange) <span style=color:#f92672>&gt;=</span> cut_off_logFC, 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>ifelse</span>(data<span style=color:#f92672>$</span>log2FoldChange <span style=color:#f92672>&gt;</span> cut_off_logFC, <span style=color:#e6db74>&#39;Up&#39;</span>, <span style=color:#e6db74>&#39;Down&#39;</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Stable&#39;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span>p <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>ggplot</span>(
</span></span><span style=display:flex><span>    data,  <span style=color:#75715e># 使用的数据框</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>aes</span>(
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> log2FoldChange,  <span style=color:#75715e># x 轴表示基因的对数倍变化</span>
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>log10</span>(pvalue),  <span style=color:#75715e># y 轴表示-p 值的对数</span>
</span></span><span style=display:flex><span>        colour <span style=color:#f92672>=</span> change,     <span style=color:#75715e># 根据变化情况着色</span>
</span></span><span style=display:flex><span>    )) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_point</span>(
</span></span><span style=display:flex><span>        alpha <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.4</span>,  <span style=color:#75715e># 设置散点的透明度</span>
</span></span><span style=display:flex><span>        size <span style=color:#f92672>=</span> <span style=color:#ae81ff>3.5</span>,   <span style=color:#75715e># 设置散点的大小</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>scale_color_manual</span>(values <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;#546de5&#34;</span>, <span style=color:#e6db74>&#34;#d2dae2&#34;</span>, <span style=color:#e6db74>&#34;#ff4757&#34;</span>)) <span style=color:#f92672>+</span>  <span style=color:#75715e># 手动设置颜色</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_vline</span>(xintercept <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>-1</span>, <span style=color:#ae81ff>1</span>), lty <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>, col <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;black&#34;</span>, lwd <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.8</span>) <span style=color:#f92672>+</span>  <span style=color:#75715e># 添加垂直虚线</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>log10</span>(cut_off_pvalue), lty <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>, col <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;black&#34;</span>, lwd <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.8</span>) <span style=color:#f92672>+</span>  <span style=color:#75715e># 添加水平虚线</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>labs</span>(
</span></span><span style=display:flex><span>        x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;log2(fold change)&#34;</span>,  <span style=color:#75715e># x 轴标签</span>
</span></span><span style=display:flex><span>        y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;-log10 (p-value)&#34;</span>    <span style=color:#75715e># y 轴标签</span>
</span></span><span style=display:flex><span>    ) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme_bw</span>() <span style=color:#f92672>+</span>  <span style=color:#75715e># 使用白底主题</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>theme</span>(
</span></span><span style=display:flex><span>        plot.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(hjust <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>),  <span style=color:#75715e># 设置标题居中</span>
</span></span><span style=display:flex><span>        legend.position <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;right&#34;</span>,               <span style=color:#75715e># 设置图例位置</span>
</span></span><span style=display:flex><span>        legend.title <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>()           <span style=color:#75715e># 隐藏图例标题</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>plot <span style=color:#f92672>&lt;-</span> p
</span></span><span style=display:flex><span>plot <span style=color:#75715e># 绘图并展示</span>
</span></span></code></pre></div><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog/202311242219293.png alt></p><p>将绘图结果保存为文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#a6e22e>ggsave</span>(plot, filename <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;volcano.png&#34;</span>, width <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>, height <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>, dpi <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>)
</span></span></code></pre></div></div></article></main><script src=https://giscus.app/client.js data-repo=UncleCAT4/blog data-repo-id=R_kgDOKXKUsQ data-category=Announcements data-category-id=DIC_kwDOKXKUsc4CZj38 data-mapping=title data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async></script></div></div></div><script async defer src=/js/menu.js></script></body></html>