<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>TBtools 制作基因表达热图详解 - 猫四叔</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content><meta property="og:title" content="TBtools 制作基因表达热图详解"><meta property="og:description" content="使用 TBtools 制作基因表达热图实在是方便，美化起来也很简单，本文以水稻的一组基因为例，讲述基因表达数据的获取、处理并使用 TBtools 出图。"><meta property="og:type" content="article"><meta property="og:url" content="https://yuanj.top/posts/81ccbfae/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-23T12:07:50+00:00"><meta property="article:modified_time" content="2023-06-23T12:07:50+00:00"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=/css/style.css></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=/ title=猫四叔 rel=home><div class="logo__item logo__text"><div class=logo__title>猫四叔</div><div class=logo__tagline>思绪来得快去得也快，偶尔会在这里停留</div></div></a></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>TBtools 制作基因表达热图详解</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><time class=meta__text datetime=2023-06-23T12:07:50Z>June 23, 2023</time></div></div></header><div class="content post__content clearfix"><p>使用 TBtools 制作基因表达热图实在是方便，美化起来也很简单，本文以水稻的一组基因为例，讲述基因表达数据的获取、处理并使用 TBtools 出图。</p><h2 id=数据准备>数据准备</h2><p>基因表达量数据一般由实验得来，对于一些物种也会有相对的数据库提供各种条件下实验得来的数据，我们课题组做的大都与水稻有关，我就以水稻的为例</p><p><a href=http://expression.ic4r.org/>RED</a> 数据库提供了多数水稻基因在不同条件下的表达量数据，输入基因名称进行搜索，这里使用 RAP ID 或者 MUS ID 都可以，只不过貌似 RAP ID 的要全一点，很多 MUS ID 的都找不到</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623123234.png alt></p><p>搜索完成后，这里有很多的 Project，每个 Project 对应不同的实验条件，例如 DRP000391 就是正常状况下的表达量</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623123524.png alt></p><p>从 Project 的详情页的可以看到该项目的实验条件</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623123605.png alt></p><p>点击<code>Show Data</code>然后导出数据，这里要注意一下，导出数据是需要 flash 支持的，但 21 年开始 chrome、edge 这些浏览器已经不支持 flash 了，可以使用 360 浏览器或者搜狗浏览器这些，我提供一个绿色版的 <a href=https://www.123pan.com/s/JYtA-SeW0v.html>360 浏览器便携版</a>，解压之后打开<code>360chrome.exe</code>直接使用</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623124152.png alt></p><p>导出之后对数据进行处理，使用 Excel 的筛选功能，将数据整理成基因名称与各个项目的数据相对应的形式</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623124953.png alt></p><p>对数据进行 <code>Log2</code> 处理，报错的值一律改为 0 即可</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623125050.png alt></p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623125135.png alt></p><h2 id=绘图>绘图</h2><p>打开 TBtools 的 <code>Heatmap</code> 功能，把数据表格粘贴进去，start 出图</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623125233.png alt></p><h2 id=美化>美化</h2><p>默认的图颜色并不是很美观，我们可以对它进行调整点击 Show Control Dialog 打开控制面板，具体的参数注释如下</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623125518.png alt></p><p>一般就是先对其进行聚类，然后调整颜色，我个人一般把 0.00 作为分界线改为白色，图形改为圆形，将上下限改为一样的数值，那么中心值自然就是 0.00 了</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623125936.png alt></p><p>然后修改字体，个人一般喜欢新罗马字体</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623130249.png alt></p><h2 id=导出图形>导出图形</h2><p>最好选 600dpi 的，这个像素要高一些，更加清晰</p><p><img src=https://jihulab.com/UncleCAT4/static/-/raw/main/blog-images/20230623130336.png alt></p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=/posts/2eef5da0/ rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>蛋白互作网络美化</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=/posts/8c3c2e59/ rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>基因进化树的制作及其美化</p></a></div></nav></div></div></div><script async defer src=/js/menu.js></script></body></html>